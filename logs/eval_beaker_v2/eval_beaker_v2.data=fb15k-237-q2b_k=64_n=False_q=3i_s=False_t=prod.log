2021-04-29 19:53:18,108 INFO     ---------------------------------------------------------------------------------------------
2021-04-29 19:53:18,108 INFO     Geo: cqd
2021-04-29 19:53:18,109 INFO     Data Path: data/FB15k-237-q2b
2021-04-29 19:53:18,109 INFO     #entity: 14505
2021-04-29 19:53:18,109 INFO     #relation: 474
2021-04-29 19:53:18,109 INFO     #max steps: 1000
2021-04-29 19:53:18,109 INFO     Evaluate unoins using: DNF
2021-04-29 19:53:18,109 INFO     loading data
2021-04-29 19:53:54,067 INFO     Training info:
2021-04-29 19:53:54,068 INFO     Validation info:
2021-04-29 19:53:54,069 INFO     3i: 5000
2021-04-29 19:53:54,075 INFO     Test info:
2021-04-29 19:53:54,075 INFO     3i: 5000
2021-04-29 19:53:54,431 INFO     Model Parameter Configuration:
2021-04-29 19:53:54,431 INFO     Parameter embeddings.0.weight: torch.Size([14505, 2000]), require_grad = True
2021-04-29 19:53:54,432 INFO     Parameter embeddings.1.weight: torch.Size([474, 2000]), require_grad = True
2021-04-29 19:53:54,432 INFO     Parameter Number: 29958000
2021-04-29 19:53:59,197 INFO     Loading checkpoint models/fb15k-237-q2b...
2021-04-29 19:53:59,654 INFO     tasks = 3i
2021-04-29 19:53:59,654 INFO     init_step = 99999
2021-04-29 19:53:59,654 INFO     batch_size = 1000
2021-04-29 19:53:59,654 INFO     hidden_dim = 1000
2021-04-29 19:53:59,654 INFO     gamma = 12.000000
2021-04-29 19:53:59,654 INFO     Evaluating on Valid Dataset...
  0%|          | 0/5000 [00:00<?, ?it/s]2021-04-29 19:53:59,671 INFO     Evaluating the model... (0/5000)
  0%|          | 12/5000 [00:00<00:43, 114.77it/s]  1%|          | 27/5000 [00:00<00:40, 122.88it/s]  1%|          | 41/5000 [00:00<00:38, 127.35it/s]  1%|          | 62/5000 [00:00<00:34, 143.94it/s]  2%|▏         | 83/5000 [00:00<00:31, 158.51it/s]  2%|▏         | 105/5000 [00:00<00:28, 171.84it/s]  3%|▎         | 126/5000 [00:00<00:26, 181.46it/s]  3%|▎         | 148/5000 [00:00<00:25, 190.15it/s]  3%|▎         | 169/5000 [00:00<00:24, 195.04it/s]  4%|▍         | 190/5000 [00:01<00:24, 199.08it/s]  4%|▍         | 212/5000 [00:01<00:23, 204.52it/s]  5%|▍         | 234/5000 [00:01<00:22, 207.32it/s]  5%|▌         | 256/5000 [00:01<00:22, 209.28it/s]  6%|▌         | 278/5000 [00:01<00:22, 211.26it/s]  6%|▌         | 300/5000 [00:01<00:22, 210.46it/s]  6%|▋         | 322/5000 [00:01<00:22, 211.34it/s]  7%|▋         | 344/5000 [00:01<00:28, 161.76it/s]  7%|▋         | 362/5000 [00:02<00:34, 136.18it/s]  8%|▊         | 378/5000 [00:02<00:34, 133.84it/s]  8%|▊         | 393/5000 [00:02<00:35, 128.15it/s]  8%|▊         | 415/5000 [00:02<00:31, 145.40it/s]  9%|▊         | 435/5000 [00:02<00:29, 156.64it/s]  9%|▉         | 456/5000 [00:02<00:27, 167.81it/s] 10%|▉         | 478/5000 [00:02<00:25, 178.72it/s] 10%|▉         | 499/5000 [00:02<00:24, 186.73it/s] 10%|█         | 521/5000 [00:02<00:23, 194.01it/s] 11%|█         | 542/5000 [00:03<00:22, 198.09it/s] 11%|█▏        | 564/5000 [00:03<00:21, 202.34it/s] 12%|█▏        | 585/5000 [00:03<00:21, 204.35it/s] 12%|█▏        | 607/5000 [00:03<00:21, 206.96it/s] 13%|█▎        | 628/5000 [00:03<00:21, 206.59it/s] 13%|█▎        | 650/5000 [00:03<00:20, 208.48it/s] 13%|█▎        | 671/5000 [00:03<00:22, 189.69it/s] 14%|█▍        | 691/5000 [00:03<00:31, 134.86it/s] 14%|█▍        | 709/5000 [00:04<00:31, 138.28it/s] 14%|█▍        | 725/5000 [00:04<00:30, 141.63it/s] 15%|█▍        | 741/5000 [00:04<00:29, 143.53it/s] 15%|█▌        | 762/5000 [00:04<00:26, 158.18it/s] 16%|█▌        | 784/5000 [00:04<00:24, 172.41it/s] 16%|█▌        | 806/5000 [00:04<00:23, 182.29it/s] 17%|█▋        | 828/5000 [00:04<00:21, 191.88it/s] 17%|█▋        | 850/5000 [00:04<00:20, 198.12it/s] 17%|█▋        | 872/5000 [00:04<00:20, 203.86it/s] 18%|█▊        | 893/5000 [00:04<00:19, 205.62it/s] 18%|█▊        | 915/5000 [00:05<00:19, 209.01it/s] 19%|█▊        | 937/5000 [00:05<00:19, 211.88it/s] 19%|█▉        | 959/5000 [00:05<00:19, 212.31it/s] 20%|█▉        | 981/5000 [00:05<00:18, 214.24it/s]2021-04-29 19:54:05,100 INFO     Evaluating the model... (1000/5000)
 20%|██        | 1003/5000 [00:05<00:18, 211.75it/s] 20%|██        | 1025/5000 [00:05<00:19, 201.33it/s] 21%|██        | 1046/5000 [00:05<00:29, 135.29it/s] 21%|██▏       | 1063/5000 [00:05<00:28, 136.75it/s] 22%|██▏       | 1079/5000 [00:06<00:28, 135.58it/s] 22%|██▏       | 1097/5000 [00:06<00:26, 145.82it/s] 22%|██▏       | 1119/5000 [00:06<00:24, 161.48it/s] 23%|██▎       | 1141/5000 [00:06<00:22, 174.48it/s] 23%|██▎       | 1163/5000 [00:06<00:20, 185.20it/s] 24%|██▎       | 1185/5000 [00:06<00:19, 193.44it/s] 24%|██▍       | 1207/5000 [00:06<00:18, 199.72it/s] 25%|██▍       | 1229/5000 [00:06<00:18, 204.33it/s] 25%|██▌       | 1251/5000 [00:06<00:18, 206.17it/s] 25%|██▌       | 1273/5000 [00:07<00:17, 208.57it/s] 26%|██▌       | 1295/5000 [00:07<00:17, 208.69it/s] 26%|██▋       | 1317/5000 [00:07<00:17, 208.95it/s] 27%|██▋       | 1339/5000 [00:07<00:17, 209.09it/s] 27%|██▋       | 1360/5000 [00:07<00:17, 208.52it/s] 28%|██▊       | 1382/5000 [00:07<00:17, 209.19it/s] 28%|██▊       | 1403/5000 [00:07<00:22, 158.48it/s] 28%|██▊       | 1421/5000 [00:07<00:26, 137.62it/s] 29%|██▊       | 1437/5000 [00:08<00:25, 137.43it/s] 29%|██▉       | 1452/5000 [00:08<00:27, 129.41it/s] 29%|██▉       | 1474/5000 [00:08<00:23, 147.35it/s] 30%|██▉       | 1496/5000 [00:08<00:21, 163.38it/s] 30%|███       | 1518/5000 [00:08<00:19, 176.30it/s] 31%|███       | 1540/5000 [00:08<00:18, 185.39it/s] 31%|███       | 1562/5000 [00:08<00:17, 193.64it/s] 32%|███▏      | 1584/5000 [00:08<00:17, 198.56it/s] 32%|███▏      | 1606/5000 [00:08<00:16, 203.99it/s] 33%|███▎      | 1628/5000 [00:08<00:16, 207.60it/s] 33%|███▎      | 1651/5000 [00:09<00:15, 211.25it/s] 33%|███▎      | 1674/5000 [00:09<00:15, 215.02it/s] 34%|███▍      | 1696/5000 [00:09<00:15, 214.17it/s] 34%|███▍      | 1718/5000 [00:09<00:15, 214.21it/s] 35%|███▍      | 1740/5000 [00:09<00:15, 214.45it/s] 35%|███▌      | 1762/5000 [00:09<00:16, 191.13it/s] 36%|███▌      | 1782/5000 [00:09<00:24, 132.77it/s] 36%|███▌      | 1799/5000 [00:10<00:23, 134.69it/s] 36%|███▋      | 1815/5000 [00:10<00:24, 129.32it/s] 37%|███▋      | 1837/5000 [00:10<00:21, 146.83it/s] 37%|███▋      | 1859/5000 [00:10<00:19, 161.63it/s] 38%|███▊      | 1881/5000 [00:10<00:17, 174.92it/s] 38%|███▊      | 1903/5000 [00:10<00:16, 185.60it/s] 38%|███▊      | 1924/5000 [00:10<00:16, 191.88it/s] 39%|███▉      | 1945/5000 [00:10<00:15, 192.48it/s] 39%|███▉      | 1968/5000 [00:10<00:15, 200.52it/s] 40%|███▉      | 1990/5000 [00:10<00:14, 204.15it/s]2021-04-29 19:54:10,684 INFO     Evaluating the model... (2000/5000)
 40%|████      | 2012/5000 [00:11<00:14, 208.09it/s] 41%|████      | 2035/5000 [00:11<00:13, 212.01it/s] 41%|████      | 2059/5000 [00:11<00:13, 217.38it/s] 42%|████▏     | 2085/5000 [00:11<00:12, 227.34it/s] 42%|████▏     | 2111/5000 [00:11<00:12, 234.78it/s] 43%|████▎     | 2135/5000 [00:11<00:15, 180.11it/s] 43%|████▎     | 2156/5000 [00:11<00:17, 159.11it/s] 43%|████▎     | 2174/5000 [00:11<00:17, 160.83it/s] 44%|████▍     | 2192/5000 [00:12<00:18, 151.12it/s] 44%|████▍     | 2217/5000 [00:12<00:16, 171.25it/s] 45%|████▍     | 2243/5000 [00:12<00:14, 189.17it/s] 45%|████▌     | 2268/5000 [00:12<00:13, 203.32it/s] 46%|████▌     | 2294/5000 [00:12<00:12, 215.77it/s] 46%|████▋     | 2320/5000 [00:12<00:11, 225.79it/s] 47%|████▋     | 2345/5000 [00:12<00:11, 232.04it/s] 47%|████▋     | 2371/5000 [00:12<00:11, 237.94it/s] 48%|████▊     | 2396/5000 [00:12<00:10, 238.94it/s] 48%|████▊     | 2422/5000 [00:13<00:10, 242.20it/s] 49%|████▉     | 2448/5000 [00:13<00:10, 244.66it/s] 49%|████▉     | 2473/5000 [00:13<00:10, 243.98it/s] 50%|████▉     | 2498/5000 [00:13<00:10, 244.34it/s] 50%|█████     | 2523/5000 [00:13<00:10, 244.83it/s] 51%|█████     | 2548/5000 [00:13<00:10, 225.67it/s] 51%|█████▏    | 2571/5000 [00:13<00:15, 151.92it/s] 52%|█████▏    | 2592/5000 [00:13<00:15, 156.21it/s] 52%|█████▏    | 2611/5000 [00:14<00:14, 163.42it/s] 53%|█████▎    | 2630/5000 [00:14<00:14, 165.20it/s] 53%|█████▎    | 2655/5000 [00:14<00:12, 182.41it/s] 54%|█████▎    | 2681/5000 [00:14<00:11, 198.94it/s] 54%|█████▍    | 2707/5000 [00:14<00:10, 213.18it/s] 55%|█████▍    | 2733/5000 [00:14<00:10, 223.15it/s] 55%|█████▌    | 2759/5000 [00:14<00:09, 232.24it/s] 56%|█████▌    | 2785/5000 [00:14<00:09, 238.98it/s] 56%|█████▌    | 2811/5000 [00:14<00:09, 242.33it/s] 57%|█████▋    | 2837/5000 [00:15<00:08, 245.99it/s] 57%|█████▋    | 2863/5000 [00:15<00:08, 247.54it/s] 58%|█████▊    | 2889/5000 [00:15<00:08, 249.74it/s] 58%|█████▊    | 2915/5000 [00:15<00:08, 250.27it/s] 59%|█████▉    | 2941/5000 [00:15<00:08, 249.07it/s] 59%|█████▉    | 2966/5000 [00:15<00:08, 249.28it/s] 60%|█████▉    | 2991/5000 [00:15<00:10, 191.57it/s]2021-04-29 19:54:15,508 INFO     Evaluating the model... (3000/5000)
 60%|██████    | 3013/5000 [00:15<00:12, 162.41it/s] 61%|██████    | 3032/5000 [00:16<00:12, 162.49it/s] 61%|██████    | 3050/5000 [00:16<00:12, 154.00it/s] 62%|██████▏   | 3076/5000 [00:16<00:11, 174.23it/s] 62%|██████▏   | 3103/5000 [00:16<00:09, 194.09it/s] 63%|██████▎   | 3129/5000 [00:16<00:08, 209.43it/s] 63%|██████▎   | 3154/5000 [00:16<00:08, 219.79it/s] 64%|██████▎   | 3180/5000 [00:16<00:07, 228.70it/s] 64%|██████▍   | 3206/5000 [00:16<00:07, 235.66it/s] 65%|██████▍   | 3231/5000 [00:16<00:07, 238.76it/s] 65%|██████▌   | 3257/5000 [00:16<00:07, 242.29it/s] 66%|██████▌   | 3283/5000 [00:17<00:07, 245.22it/s] 66%|██████▌   | 3308/5000 [00:17<00:06, 245.69it/s] 67%|██████▋   | 3334/5000 [00:17<00:06, 247.92it/s] 67%|██████▋   | 3360/5000 [00:17<00:06, 248.86it/s] 68%|██████▊   | 3385/5000 [00:17<00:06, 248.24it/s] 68%|██████▊   | 3410/5000 [00:17<00:06, 239.42it/s] 69%|██████▊   | 3435/5000 [00:17<00:08, 190.46it/s] 69%|██████▉   | 3456/5000 [00:17<00:09, 168.83it/s] 70%|██████▉   | 3475/5000 [00:18<00:09, 167.38it/s] 70%|██████▉   | 3493/5000 [00:18<00:09, 154.85it/s] 70%|███████   | 3518/5000 [00:18<00:08, 174.12it/s] 71%|███████   | 3543/5000 [00:18<00:07, 190.99it/s] 71%|███████▏  | 3568/5000 [00:18<00:06, 205.50it/s] 72%|███████▏  | 3594/5000 [00:18<00:06, 217.15it/s] 72%|███████▏  | 3620/5000 [00:18<00:06, 226.21it/s] 73%|███████▎  | 3645/5000 [00:18<00:05, 230.49it/s] 73%|███████▎  | 3671/5000 [00:18<00:05, 236.09it/s] 74%|███████▍  | 3697/5000 [00:19<00:05, 240.28it/s] 74%|███████▍  | 3723/5000 [00:19<00:05, 243.33it/s] 75%|███████▍  | 3748/5000 [00:19<00:05, 240.76it/s] 75%|███████▌  | 3773/5000 [00:19<00:05, 242.44it/s] 76%|███████▌  | 3798/5000 [00:19<00:04, 243.13it/s] 76%|███████▋  | 3823/5000 [00:19<00:04, 243.78it/s] 77%|███████▋  | 3848/5000 [00:19<00:05, 224.62it/s] 77%|███████▋  | 3871/5000 [00:19<00:07, 151.86it/s] 78%|███████▊  | 3890/5000 [00:20<00:07, 156.73it/s] 78%|███████▊  | 3909/5000 [00:20<00:06, 163.05it/s] 79%|███████▊  | 3928/5000 [00:20<00:06, 164.41it/s] 79%|███████▉  | 3953/5000 [00:20<00:05, 183.11it/s] 80%|███████▉  | 3978/5000 [00:20<00:05, 198.22it/s]2021-04-29 19:54:20,216 INFO     Evaluating the model... (4000/5000)
 80%|████████  | 4002/5000 [00:20<00:04, 208.98it/s] 81%|████████  | 4028/5000 [00:20<00:04, 219.96it/s] 81%|████████  | 4054/5000 [00:20<00:04, 228.33it/s] 82%|████████▏ | 4080/5000 [00:20<00:03, 234.53it/s] 82%|████████▏ | 4105/5000 [00:20<00:03, 236.75it/s] 83%|████████▎ | 4131/5000 [00:21<00:03, 241.44it/s] 83%|████████▎ | 4157/5000 [00:21<00:03, 244.57it/s] 84%|████████▎ | 4183/5000 [00:21<00:03, 247.49it/s] 84%|████████▍ | 4209/5000 [00:21<00:03, 250.11it/s] 85%|████████▍ | 4235/5000 [00:21<00:03, 250.77it/s] 85%|████████▌ | 4261/5000 [00:21<00:02, 252.28it/s] 86%|████████▌ | 4287/5000 [00:21<00:03, 187.77it/s] 86%|████████▌ | 4309/5000 [00:22<00:04, 159.01it/s] 87%|████████▋ | 4328/5000 [00:22<00:04, 160.10it/s] 87%|████████▋ | 4346/5000 [00:22<00:04, 152.78it/s] 87%|████████▋ | 4372/5000 [00:22<00:03, 173.00it/s] 88%|████████▊ | 4397/5000 [00:22<00:03, 189.65it/s] 88%|████████▊ | 4422/5000 [00:22<00:02, 204.39it/s] 89%|████████▉ | 4448/5000 [00:22<00:02, 216.30it/s] 89%|████████▉ | 4473/5000 [00:22<00:02, 225.36it/s] 90%|████████▉ | 4498/5000 [00:22<00:02, 230.93it/s] 90%|█████████ | 4524/5000 [00:22<00:02, 236.36it/s] 91%|█████████ | 4549/5000 [00:23<00:01, 240.23it/s] 92%|█████████▏| 4575/5000 [00:23<00:01, 243.93it/s] 92%|█████████▏| 4601/5000 [00:23<00:01, 245.88it/s] 93%|█████████▎| 4627/5000 [00:23<00:01, 249.90it/s] 93%|█████████▎| 4653/5000 [00:23<00:01, 251.65it/s] 94%|█████████▎| 4679/5000 [00:23<00:01, 251.40it/s] 94%|█████████▍| 4705/5000 [00:23<00:01, 187.02it/s] 95%|█████████▍| 4727/5000 [00:24<00:01, 148.79it/s] 95%|█████████▍| 4746/5000 [00:24<00:01, 158.85it/s] 95%|█████████▌| 4765/5000 [00:24<00:01, 163.11it/s] 96%|█████████▌| 4790/5000 [00:24<00:01, 181.95it/s] 96%|█████████▋| 4816/5000 [00:24<00:00, 198.67it/s] 97%|█████████▋| 4842/5000 [00:24<00:00, 212.57it/s] 97%|█████████▋| 4868/5000 [00:24<00:00, 222.04it/s] 98%|█████████▊| 4892/5000 [00:24<00:00, 214.46it/s] 98%|█████████▊| 4915/5000 [00:24<00:00, 216.43it/s] 99%|█████████▉| 4938/5000 [00:24<00:00, 218.97it/s] 99%|█████████▉| 4961/5000 [00:25<00:00, 218.55it/s]100%|█████████▉| 4984/5000 [00:25<00:00, 213.46it/s]100%|██████████| 5000/5000 [00:25<00:00, 197.82it/s]
2021-04-29 19:54:24,940 INFO     Valid 3i MRR at step 99999: 0.443290
2021-04-29 19:54:24,940 INFO     Valid 3i HITS1 at step 99999: 0.333928
2021-04-29 19:54:24,941 INFO     Valid 3i HITS3 at step 99999: 0.500609
2021-04-29 19:54:24,941 INFO     Valid 3i HITS10 at step 99999: 0.658181
2021-04-29 19:54:24,941 INFO     Valid 3i num_queries at step 99999: 5000.000000
2021-04-29 19:54:24,943 INFO     Valid average MRR at step 99999: 0.443290
2021-04-29 19:54:24,943 INFO     Valid average HITS1 at step 99999: 0.333928
2021-04-29 19:54:24,944 INFO     Valid average HITS3 at step 99999: 0.500609
2021-04-29 19:54:24,944 INFO     Valid average HITS10 at step 99999: 0.658181
2021-04-29 19:54:24,945 INFO     Evaluating on Test Dataset...
  0%|          | 0/5000 [00:00<?, ?it/s]2021-04-29 19:54:24,955 INFO     Evaluating the model... (0/5000)
  0%|          | 20/5000 [00:00<00:25, 194.86it/s]  1%|          | 46/5000 [00:00<00:23, 210.15it/s]  1%|          | 60/5000 [00:00<00:27, 179.49it/s]  1%|▏         | 73/5000 [00:00<00:30, 159.12it/s]  2%|▏         | 86/5000 [00:00<00:37, 130.49it/s]  2%|▏         | 102/5000 [00:00<00:35, 137.88it/s]  2%|▏         | 121/5000 [00:00<00:33, 147.25it/s]  3%|▎         | 140/5000 [00:00<00:30, 157.61it/s]  3%|▎         | 166/5000 [00:00<00:27, 178.02it/s]  4%|▍         | 192/5000 [00:01<00:24, 195.72it/s]  4%|▍         | 218/5000 [00:01<00:22, 210.28it/s]  5%|▍         | 244/5000 [00:01<00:21, 221.86it/s]  5%|▌         | 270/5000 [00:01<00:20, 230.92it/s]  6%|▌         | 296/5000 [00:01<00:19, 237.65it/s]  6%|▋         | 322/5000 [00:01<00:19, 242.55it/s]  7%|▋         | 348/5000 [00:01<00:18, 247.41it/s]  8%|▊         | 375/5000 [00:01<00:18, 251.71it/s]  8%|▊         | 401/5000 [00:01<00:18, 253.94it/s]  9%|▊         | 427/5000 [00:01<00:17, 254.70it/s]  9%|▉         | 453/5000 [00:02<00:17, 253.09it/s] 10%|▉         | 479/5000 [00:02<00:18, 244.27it/s] 10%|█         | 504/5000 [00:02<00:24, 182.18it/s] 10%|█         | 525/5000 [00:02<00:26, 171.51it/s] 11%|█         | 544/5000 [00:02<00:26, 168.48it/s] 11%|█▏        | 563/5000 [00:02<00:27, 159.48it/s] 12%|█▏        | 589/5000 [00:02<00:24, 179.03it/s] 12%|█▏        | 614/5000 [00:03<00:22, 195.34it/s] 13%|█▎        | 636/5000 [00:03<00:24, 177.12it/s] 13%|█▎        | 662/5000 [00:03<00:22, 194.33it/s] 14%|█▍        | 689/5000 [00:03<00:20, 211.34it/s] 14%|█▍        | 715/5000 [00:03<00:19, 223.52it/s] 15%|█▍        | 742/5000 [00:03<00:18, 233.98it/s] 15%|█▌        | 768/5000 [00:03<00:17, 240.68it/s] 16%|█▌        | 794/5000 [00:03<00:17, 245.49it/s] 16%|█▋        | 820/5000 [00:03<00:16, 246.63it/s] 17%|█▋        | 846/5000 [00:03<00:16, 249.46it/s] 17%|█▋        | 872/5000 [00:04<00:16, 250.08it/s] 18%|█▊        | 898/5000 [00:04<00:22, 184.11it/s] 18%|█▊        | 920/5000 [00:04<00:25, 159.46it/s] 19%|█▉        | 939/5000 [00:04<00:26, 154.19it/s] 19%|█▉        | 957/5000 [00:04<00:25, 156.72it/s] 20%|█▉        | 980/5000 [00:04<00:23, 173.17it/s]2021-04-29 19:54:29,870 INFO     Evaluating the model... (1000/5000)
 20%|██        | 1005/5000 [00:04<00:21, 189.80it/s] 21%|██        | 1030/5000 [00:05<00:19, 203.92it/s] 21%|██        | 1055/5000 [00:05<00:18, 215.80it/s] 22%|██▏       | 1080/5000 [00:05<00:17, 224.97it/s] 22%|██▏       | 1105/5000 [00:05<00:16, 230.24it/s] 23%|██▎       | 1130/5000 [00:05<00:16, 235.70it/s] 23%|██▎       | 1155/5000 [00:05<00:16, 239.76it/s] 24%|██▎       | 1181/5000 [00:05<00:15, 242.95it/s] 24%|██▍       | 1206/5000 [00:05<00:15, 243.48it/s] 25%|██▍       | 1231/5000 [00:05<00:15, 243.40it/s] 25%|██▌       | 1257/5000 [00:05<00:15, 245.41it/s] 26%|██▌       | 1282/5000 [00:06<00:16, 229.34it/s] 26%|██▌       | 1306/5000 [00:06<00:24, 151.73it/s] 26%|██▋       | 1325/5000 [00:06<00:23, 158.48it/s] 27%|██▋       | 1344/5000 [00:06<00:22, 161.92it/s] 27%|██▋       | 1363/5000 [00:06<00:22, 158.62it/s] 28%|██▊       | 1382/5000 [00:06<00:21, 165.23it/s] 28%|██▊       | 1404/5000 [00:06<00:20, 177.13it/s] 29%|██▊       | 1426/5000 [00:07<00:19, 186.26it/s] 29%|██▉       | 1448/5000 [00:07<00:18, 192.92it/s] 29%|██▉       | 1470/5000 [00:07<00:17, 200.12it/s] 30%|██▉       | 1492/5000 [00:07<00:17, 203.64it/s] 30%|███       | 1514/5000 [00:07<00:16, 206.75it/s] 31%|███       | 1537/5000 [00:07<00:16, 213.08it/s] 31%|███       | 1560/5000 [00:07<00:15, 216.50it/s] 32%|███▏      | 1582/5000 [00:07<00:15, 215.70it/s] 32%|███▏      | 1605/5000 [00:07<00:15, 218.65it/s] 33%|███▎      | 1628/5000 [00:07<00:15, 220.00it/s] 33%|███▎      | 1651/5000 [00:08<00:18, 176.33it/s] 33%|███▎      | 1671/5000 [00:08<00:23, 144.74it/s] 34%|███▍      | 1688/5000 [00:08<00:22, 144.10it/s] 34%|███▍      | 1704/5000 [00:08<00:24, 132.24it/s] 35%|███▍      | 1726/5000 [00:08<00:21, 149.82it/s] 35%|███▍      | 1747/5000 [00:08<00:19, 163.38it/s] 35%|███▌      | 1765/5000 [00:08<00:19, 167.30it/s] 36%|███▌      | 1787/5000 [00:09<00:17, 179.04it/s] 36%|███▌      | 1809/5000 [00:09<00:16, 188.34it/s] 37%|███▋      | 1829/5000 [00:09<00:16, 188.01it/s] 37%|███▋      | 1855/5000 [00:09<00:15, 204.60it/s] 38%|███▊      | 1880/5000 [00:09<00:14, 214.81it/s] 38%|███▊      | 1906/5000 [00:09<00:13, 224.98it/s] 39%|███▊      | 1932/5000 [00:09<00:13, 234.13it/s] 39%|███▉      | 1958/5000 [00:09<00:12, 238.88it/s] 40%|███▉      | 1984/5000 [00:09<00:12, 243.12it/s]2021-04-29 19:54:34,839 INFO     Evaluating the model... (2000/5000)
 40%|████      | 2009/5000 [00:09<00:12, 242.98it/s] 41%|████      | 2035/5000 [00:10<00:12, 245.27it/s] 41%|████      | 2060/5000 [00:10<00:14, 198.19it/s] 42%|████▏     | 2082/5000 [00:10<00:18, 155.50it/s] 42%|████▏     | 2101/5000 [00:10<00:17, 161.14it/s] 42%|████▏     | 2119/5000 [00:10<00:18, 153.11it/s] 43%|████▎     | 2145/5000 [00:10<00:16, 173.72it/s] 43%|████▎     | 2171/5000 [00:10<00:14, 192.03it/s] 44%|████▍     | 2197/5000 [00:10<00:13, 207.24it/s] 44%|████▍     | 2223/5000 [00:11<00:12, 218.71it/s] 45%|████▍     | 2249/5000 [00:11<00:12, 228.26it/s] 46%|████▌     | 2275/5000 [00:11<00:11, 235.58it/s] 46%|████▌     | 2301/5000 [00:11<00:11, 241.15it/s] 47%|████▋     | 2327/5000 [00:11<00:10, 245.03it/s] 47%|████▋     | 2353/5000 [00:11<00:10, 248.21it/s] 48%|████▊     | 2379/5000 [00:11<00:10, 250.66it/s] 48%|████▊     | 2405/5000 [00:11<00:10, 252.47it/s] 49%|████▊     | 2431/5000 [00:11<00:10, 253.18it/s] 49%|████▉     | 2457/5000 [00:11<00:10, 251.41it/s] 50%|████▉     | 2483/5000 [00:12<00:12, 201.51it/s] 50%|█████     | 2505/5000 [00:12<00:15, 160.81it/s] 50%|█████     | 2524/5000 [00:12<00:15, 160.82it/s] 51%|█████     | 2542/5000 [00:12<00:16, 151.76it/s] 51%|█████▏    | 2568/5000 [00:12<00:14, 172.85it/s] 52%|█████▏    | 2595/5000 [00:12<00:12, 192.34it/s] 52%|█████▏    | 2621/5000 [00:12<00:11, 208.07it/s] 53%|█████▎    | 2647/5000 [00:13<00:10, 220.86it/s] 53%|█████▎    | 2673/5000 [00:13<00:10, 230.07it/s] 54%|█████▍    | 2699/5000 [00:13<00:09, 237.00it/s] 55%|█████▍    | 2725/5000 [00:13<00:09, 243.39it/s] 55%|█████▌    | 2751/5000 [00:13<00:09, 245.81it/s] 56%|█████▌    | 2777/5000 [00:13<00:08, 248.36it/s] 56%|█████▌    | 2803/5000 [00:13<00:08, 251.68it/s] 57%|█████▋    | 2829/5000 [00:13<00:08, 250.96it/s] 57%|█████▋    | 2855/5000 [00:13<00:08, 252.20it/s] 58%|█████▊    | 2881/5000 [00:13<00:08, 250.78it/s] 58%|█████▊    | 2907/5000 [00:14<00:08, 249.69it/s] 59%|█████▊    | 2933/5000 [00:14<00:12, 172.04it/s] 59%|█████▉    | 2954/5000 [00:14<00:12, 166.20it/s] 59%|█████▉    | 2973/5000 [00:14<00:12, 162.21it/s] 60%|█████▉    | 2991/5000 [00:14<00:12, 161.91it/s]2021-04-29 19:54:39,688 INFO     Evaluating the model... (3000/5000)
 60%|██████    | 3017/5000 [00:14<00:10, 181.40it/s] 61%|██████    | 3043/5000 [00:14<00:09, 198.39it/s] 61%|██████▏   | 3069/5000 [00:15<00:09, 212.99it/s] 62%|██████▏   | 3095/5000 [00:15<00:08, 223.09it/s] 62%|██████▏   | 3121/5000 [00:15<00:08, 232.21it/s] 63%|██████▎   | 3146/5000 [00:15<00:08, 221.05it/s] 63%|██████▎   | 3169/5000 [00:15<00:08, 220.51it/s] 64%|██████▍   | 3192/5000 [00:15<00:08, 206.91it/s] 64%|██████▍   | 3214/5000 [00:15<00:08, 208.68it/s] 65%|██████▍   | 3236/5000 [00:15<00:08, 206.53it/s] 65%|██████▌   | 3257/5000 [00:15<00:08, 207.43it/s] 66%|██████▌   | 3279/5000 [00:15<00:08, 208.62it/s] 66%|██████▌   | 3301/5000 [00:16<00:08, 210.74it/s] 66%|██████▋   | 3323/5000 [00:16<00:08, 190.69it/s] 67%|██████▋   | 3343/5000 [00:16<00:12, 135.02it/s] 67%|██████▋   | 3360/5000 [00:16<00:13, 123.10it/s] 68%|██████▊   | 3375/5000 [00:16<00:13, 122.56it/s] 68%|██████▊   | 3396/5000 [00:16<00:11, 139.04it/s] 68%|██████▊   | 3418/5000 [00:16<00:10, 155.13it/s] 69%|██████▉   | 3440/5000 [00:17<00:09, 168.43it/s] 69%|██████▉   | 3462/5000 [00:17<00:08, 180.00it/s] 70%|██████▉   | 3483/5000 [00:17<00:08, 186.77it/s] 70%|███████   | 3505/5000 [00:17<00:07, 194.30it/s] 71%|███████   | 3526/5000 [00:17<00:07, 196.36it/s] 71%|███████   | 3548/5000 [00:17<00:07, 201.44it/s] 71%|███████▏  | 3570/5000 [00:17<00:07, 204.06it/s] 72%|███████▏  | 3592/5000 [00:17<00:06, 207.09it/s] 72%|███████▏  | 3613/5000 [00:17<00:06, 207.07it/s] 73%|███████▎  | 3634/5000 [00:18<00:06, 207.65it/s] 73%|███████▎  | 3656/5000 [00:18<00:06, 208.51it/s] 74%|███████▎  | 3677/5000 [00:18<00:07, 182.62it/s] 74%|███████▍  | 3696/5000 [00:18<00:09, 133.68it/s] 74%|███████▍  | 3712/5000 [00:18<00:09, 133.56it/s] 75%|███████▍  | 3727/5000 [00:18<00:09, 136.61it/s] 75%|███████▍  | 3743/5000 [00:18<00:08, 141.62it/s] 75%|███████▌  | 3765/5000 [00:18<00:07, 157.36it/s] 76%|███████▌  | 3787/5000 [00:19<00:07, 170.42it/s] 76%|███████▌  | 3809/5000 [00:19<00:06, 182.31it/s] 77%|███████▋  | 3831/5000 [00:19<00:06, 191.02it/s] 77%|███████▋  | 3853/5000 [00:19<00:05, 198.63it/s] 78%|███████▊  | 3875/5000 [00:19<00:05, 202.75it/s] 78%|███████▊  | 3897/5000 [00:19<00:05, 206.88it/s] 78%|███████▊  | 3919/5000 [00:19<00:05, 205.76it/s] 79%|███████▉  | 3941/5000 [00:19<00:05, 206.54it/s] 79%|███████▉  | 3963/5000 [00:19<00:04, 209.39it/s] 80%|███████▉  | 3985/5000 [00:19<00:04, 210.21it/s]2021-04-29 19:54:44,977 INFO     Evaluating the model... (4000/5000)
 80%|████████  | 4007/5000 [00:20<00:04, 208.26it/s] 81%|████████  | 4028/5000 [00:20<00:04, 206.00it/s] 81%|████████  | 4049/5000 [00:20<00:04, 204.31it/s] 81%|████████▏ | 4070/5000 [00:20<00:05, 173.16it/s] 82%|████████▏ | 4089/5000 [00:20<00:06, 132.05it/s] 82%|████████▏ | 4105/5000 [00:20<00:06, 133.42it/s] 82%|████████▏ | 4120/5000 [00:20<00:06, 130.07it/s] 83%|████████▎ | 4136/5000 [00:20<00:06, 137.19it/s] 83%|████████▎ | 4158/5000 [00:21<00:05, 153.75it/s] 84%|████████▎ | 4180/5000 [00:21<00:04, 167.47it/s] 84%|████████▍ | 4201/5000 [00:21<00:04, 177.85it/s] 84%|████████▍ | 4222/5000 [00:21<00:04, 185.78it/s] 85%|████████▍ | 4243/5000 [00:21<00:03, 190.18it/s] 85%|████████▌ | 4263/5000 [00:21<00:03, 191.88it/s] 86%|████████▌ | 4285/5000 [00:21<00:03, 198.98it/s] 86%|████████▌ | 4307/5000 [00:21<00:03, 202.76it/s] 87%|████████▋ | 4330/5000 [00:21<00:03, 208.13it/s] 87%|████████▋ | 4352/5000 [00:22<00:03, 201.30it/s] 87%|████████▋ | 4374/5000 [00:22<00:03, 205.88it/s] 88%|████████▊ | 4396/5000 [00:22<00:02, 209.18it/s] 88%|████████▊ | 4418/5000 [00:22<00:02, 207.34it/s] 89%|████████▉ | 4439/5000 [00:22<00:03, 172.30it/s] 89%|████████▉ | 4458/5000 [00:22<00:03, 145.26it/s] 89%|████████▉ | 4474/5000 [00:22<00:03, 143.83it/s] 90%|████████▉ | 4490/5000 [00:22<00:03, 135.85it/s] 90%|█████████ | 4511/5000 [00:23<00:03, 151.01it/s] 91%|█████████ | 4532/5000 [00:23<00:02, 163.93it/s] 91%|█████████ | 4554/5000 [00:23<00:02, 176.14it/s] 92%|█████████▏| 4575/5000 [00:23<00:02, 185.05it/s] 92%|█████████▏| 4597/5000 [00:23<00:02, 193.05it/s] 92%|█████████▏| 4617/5000 [00:23<00:02, 188.81it/s] 93%|█████████▎| 4639/5000 [00:23<00:01, 196.63it/s] 93%|█████████▎| 4661/5000 [00:23<00:01, 201.96it/s] 94%|█████████▎| 4682/5000 [00:23<00:01, 203.55it/s] 94%|█████████▍| 4703/5000 [00:23<00:01, 196.39it/s] 94%|█████████▍| 4725/5000 [00:24<00:01, 201.24it/s] 95%|█████████▍| 4747/5000 [00:24<00:01, 205.46it/s] 95%|█████████▌| 4768/5000 [00:24<00:01, 205.77it/s] 96%|█████████▌| 4789/5000 [00:24<00:01, 160.63it/s] 96%|█████████▌| 4807/5000 [00:24<00:01, 135.24it/s] 96%|█████████▋| 4823/5000 [00:24<00:01, 137.73it/s] 97%|█████████▋| 4839/5000 [00:24<00:01, 130.72it/s] 97%|█████████▋| 4861/5000 [00:25<00:00, 148.02it/s] 98%|█████████▊| 4882/5000 [00:25<00:00, 161.52it/s] 98%|█████████▊| 4904/5000 [00:25<00:00, 174.10it/s] 99%|█████████▊| 4926/5000 [00:25<00:00, 184.44it/s] 99%|█████████▉| 4947/5000 [00:25<00:00, 189.10it/s] 99%|█████████▉| 4969/5000 [00:25<00:00, 196.09it/s]100%|█████████▉| 4991/5000 [00:25<00:00, 201.06it/s]100%|██████████| 5000/5000 [00:25<00:00, 194.65it/s]
2021-04-29 19:54:50,637 INFO     Test 3i MRR at step 99999: 0.438250
2021-04-29 19:54:50,638 INFO     Test 3i HITS1 at step 99999: 0.337101
2021-04-29 19:54:50,638 INFO     Test 3i HITS3 at step 99999: 0.480687
2021-04-29 19:54:50,638 INFO     Test 3i HITS10 at step 99999: 0.642778
2021-04-29 19:54:50,638 INFO     Test 3i num_queries at step 99999: 5000.000000
2021-04-29 19:54:50,639 INFO     Test average MRR at step 99999: 0.438250
2021-04-29 19:54:50,639 INFO     Test average HITS1 at step 99999: 0.337101
2021-04-29 19:54:50,639 INFO     Test average HITS3 at step 99999: 0.480687
2021-04-29 19:54:50,640 INFO     Test average HITS10 at step 99999: 0.642778
2021-04-29 19:54:50,640 INFO     Training finished!!
main.py --do_valid --do_test --data_path data/FB15k-237-q2b -n 1 -b 1000 -d 1000 -lr 0.1 --disable_warmup --max_steps 1000 --cpu_num 0 --geo cqd --valid_steps 20 --tasks 3i --print_on_screen --test_batch_size 1 --optimizer Adagrad --reg_weight 0.05 --log_steps 5 --checkpoint_path models/fb15k-237-q2b --cqd d2 --cqd-t-norm prod --cqd-k 64 --no-save --cuda
overwritting args.save_path
logging to models/fb15k-237-q2b
99999
