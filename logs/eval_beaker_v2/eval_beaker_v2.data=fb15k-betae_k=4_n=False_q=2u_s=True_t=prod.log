2021-04-30 23:00:59,121 INFO     ---------------------------------------------------------------------------------------------
2021-04-30 23:00:59,122 INFO     Geo: cqd
2021-04-30 23:00:59,122 INFO     Data Path: data/FB15k-betae
2021-04-30 23:00:59,122 INFO     #entity: 14951
2021-04-30 23:00:59,122 INFO     #relation: 2690
2021-04-30 23:00:59,122 INFO     #max steps: 1000
2021-04-30 23:00:59,122 INFO     Evaluate unoins using: DNF
2021-04-30 23:00:59,122 INFO     loading data
2021-04-30 23:02:24,060 INFO     Training info:
2021-04-30 23:02:24,061 INFO     Validation info:
2021-04-30 23:02:24,063 INFO     2u-DNF: 8000
2021-04-30 23:02:24,076 INFO     Test info:
2021-04-30 23:02:24,076 INFO     2u-DNF: 8000
2021-04-30 23:02:24,430 INFO     Model Parameter Configuration:
2021-04-30 23:02:24,430 INFO     Parameter embeddings.0.weight: torch.Size([14951, 2000]), require_grad = True
2021-04-30 23:02:24,430 INFO     Parameter embeddings.1.weight: torch.Size([2690, 2000]), require_grad = True
2021-04-30 23:02:24,431 INFO     Parameter Number: 35282000
2021-04-30 23:02:28,664 INFO     Loading checkpoint models/fb15k-betae...
2021-04-30 23:02:30,559 INFO     tasks = 2u
2021-04-30 23:02:30,559 INFO     init_step = 99999
2021-04-30 23:02:30,559 INFO     batch_size = 1000
2021-04-30 23:02:30,559 INFO     hidden_dim = 1000
2021-04-30 23:02:30,559 INFO     gamma = 12.000000
2021-04-30 23:02:30,559 INFO     Evaluating on Valid Dataset...
  0%|          | 0/8000 [00:00<?, ?it/s]2021-04-30 23:02:30,576 INFO     Evaluating the model... (0/8000)
  0%|          | 24/8000 [00:00<00:34, 233.60it/s]  1%|          | 54/8000 [00:00<00:31, 250.11it/s]  1%|          | 83/8000 [00:00<00:30, 259.38it/s]  1%|▏         | 111/8000 [00:00<00:29, 264.26it/s]  2%|▏         | 140/8000 [00:00<00:29, 270.46it/s]  2%|▏         | 170/8000 [00:00<00:28, 276.99it/s]  2%|▎         | 200/8000 [00:00<00:27, 283.24it/s]  3%|▎         | 228/8000 [00:00<00:27, 279.97it/s]  3%|▎         | 255/8000 [00:00<00:28, 275.14it/s]  4%|▎         | 285/8000 [00:01<00:27, 279.10it/s]  4%|▍         | 315/8000 [00:01<00:27, 283.45it/s]  4%|▍         | 344/8000 [00:01<00:26, 284.03it/s]  5%|▍         | 373/8000 [00:01<00:27, 277.06it/s]  5%|▌         | 401/8000 [00:01<00:27, 275.88it/s]  5%|▌         | 430/8000 [00:01<00:27, 278.33it/s]  6%|▌         | 458/8000 [00:01<00:32, 229.24it/s]  6%|▌         | 487/8000 [00:01<00:30, 243.22it/s]  6%|▋         | 516/8000 [00:01<00:29, 254.53it/s]  7%|▋         | 543/8000 [00:02<00:29, 252.23it/s]  7%|▋         | 572/8000 [00:02<00:28, 260.54it/s]  8%|▊         | 602/8000 [00:02<00:27, 269.05it/s]  8%|▊         | 633/8000 [00:02<00:26, 280.11it/s]  8%|▊         | 664/8000 [00:02<00:25, 287.23it/s]  9%|▊         | 694/8000 [00:02<00:25, 285.92it/s]  9%|▉         | 723/8000 [00:02<00:25, 282.74it/s]  9%|▉         | 753/8000 [00:02<00:25, 284.83it/s] 10%|▉         | 784/8000 [00:02<00:24, 289.64it/s] 10%|█         | 814/8000 [00:02<00:25, 278.79it/s] 11%|█         | 843/8000 [00:03<00:25, 277.01it/s] 11%|█         | 874/8000 [00:03<00:25, 283.55it/s] 11%|█▏        | 906/8000 [00:03<00:24, 290.81it/s] 12%|█▏        | 937/8000 [00:03<00:23, 295.59it/s] 12%|█▏        | 969/8000 [00:03<00:23, 300.28it/s]2021-04-30 23:02:34,146 INFO     Evaluating the model... (1000/8000)
 13%|█▎        | 1001/8000 [00:03<00:23, 303.72it/s] 13%|█▎        | 1033/8000 [00:03<00:22, 306.23it/s] 13%|█▎        | 1065/8000 [00:03<00:22, 307.78it/s] 14%|█▎        | 1097/8000 [00:03<00:22, 310.43it/s] 14%|█▍        | 1129/8000 [00:04<00:25, 269.71it/s] 15%|█▍        | 1163/8000 [00:04<00:23, 286.90it/s] 15%|█▍        | 1196/8000 [00:04<00:22, 296.94it/s] 15%|█▌        | 1230/8000 [00:04<00:22, 306.86it/s] 16%|█▌        | 1264/8000 [00:04<00:21, 315.62it/s] 16%|█▌        | 1298/8000 [00:04<00:20, 322.19it/s] 17%|█▋        | 1333/8000 [00:04<00:20, 327.46it/s] 17%|█▋        | 1367/8000 [00:04<00:20, 329.86it/s] 18%|█▊        | 1401/8000 [00:04<00:21, 313.53it/s] 18%|█▊        | 1433/8000 [00:04<00:22, 295.89it/s] 18%|█▊        | 1464/8000 [00:05<00:22, 287.88it/s] 19%|█▊        | 1494/8000 [00:05<00:23, 280.24it/s] 19%|█▉        | 1524/8000 [00:05<00:23, 280.83it/s] 19%|█▉        | 1553/8000 [00:05<00:23, 276.79it/s] 20%|█▉        | 1581/8000 [00:05<00:23, 269.59it/s] 20%|██        | 1609/8000 [00:05<00:23, 271.52it/s] 20%|██        | 1638/8000 [00:05<00:23, 273.31it/s] 21%|██        | 1668/8000 [00:05<00:22, 275.99it/s] 21%|██        | 1696/8000 [00:05<00:22, 274.77it/s] 22%|██▏       | 1724/8000 [00:06<00:22, 273.16it/s] 22%|██▏       | 1752/8000 [00:06<00:22, 273.93it/s] 22%|██▏       | 1781/8000 [00:06<00:22, 278.42it/s] 23%|██▎       | 1811/8000 [00:06<00:21, 282.12it/s] 23%|██▎       | 1840/8000 [00:06<00:22, 275.32it/s] 23%|██▎       | 1868/8000 [00:06<00:22, 274.34it/s] 24%|██▎       | 1896/8000 [00:06<00:22, 275.32it/s] 24%|██▍       | 1926/8000 [00:06<00:21, 279.93it/s] 24%|██▍       | 1957/8000 [00:06<00:20, 287.81it/s] 25%|██▍       | 1988/8000 [00:06<00:20, 293.98it/s]2021-04-30 23:02:37,598 INFO     Evaluating the model... (2000/8000)
 25%|██▌       | 2020/8000 [00:07<00:19, 299.48it/s] 26%|██▌       | 2051/8000 [00:07<00:20, 290.32it/s] 26%|██▌       | 2081/8000 [00:07<00:20, 293.02it/s] 26%|██▋       | 2114/8000 [00:07<00:19, 302.17it/s] 27%|██▋       | 2149/8000 [00:07<00:18, 313.24it/s] 27%|██▋       | 2183/8000 [00:07<00:18, 320.45it/s] 28%|██▊       | 2218/8000 [00:07<00:17, 326.93it/s] 28%|██▊       | 2251/8000 [00:07<00:18, 314.02it/s] 29%|██▊       | 2283/8000 [00:07<00:19, 300.88it/s] 29%|██▉       | 2314/8000 [00:08<00:19, 292.65it/s] 29%|██▉       | 2344/8000 [00:08<00:19, 283.19it/s] 30%|██▉       | 2373/8000 [00:08<00:20, 274.33it/s] 30%|███       | 2401/8000 [00:08<00:20, 267.84it/s] 30%|███       | 2428/8000 [00:08<00:24, 230.56it/s] 31%|███       | 2454/8000 [00:08<00:23, 238.10it/s] 31%|███       | 2481/8000 [00:08<00:22, 246.71it/s] 31%|███▏      | 2510/8000 [00:08<00:21, 256.15it/s] 32%|███▏      | 2541/8000 [00:08<00:20, 265.08it/s] 32%|███▏      | 2569/8000 [00:09<00:20, 267.16it/s] 32%|███▏      | 2597/8000 [00:09<00:20, 269.31it/s] 33%|███▎      | 2625/8000 [00:09<00:20, 267.98it/s] 33%|███▎      | 2653/8000 [00:09<00:19, 271.09it/s] 34%|███▎      | 2681/8000 [00:09<00:19, 272.56it/s] 34%|███▍      | 2710/8000 [00:09<00:19, 275.04it/s] 34%|███▍      | 2739/8000 [00:09<00:18, 278.12it/s] 35%|███▍      | 2767/8000 [00:09<00:19, 275.36it/s] 35%|███▍      | 2796/8000 [00:09<00:18, 276.38it/s] 35%|███▌      | 2827/8000 [00:09<00:18, 284.13it/s] 36%|███▌      | 2856/8000 [00:10<00:18, 277.77it/s] 36%|███▌      | 2885/8000 [00:10<00:18, 280.74it/s] 36%|███▋      | 2914/8000 [00:10<00:18, 276.17it/s] 37%|███▋      | 2942/8000 [00:10<00:19, 259.34it/s] 37%|███▋      | 2971/8000 [00:10<00:18, 266.87it/s]2021-04-30 23:02:41,202 INFO     Evaluating the model... (3000/8000)
 38%|███▊      | 3001/8000 [00:10<00:18, 274.05it/s] 38%|███▊      | 3029/8000 [00:10<00:18, 274.73it/s] 38%|███▊      | 3057/8000 [00:10<00:17, 275.32it/s] 39%|███▊      | 3088/8000 [00:10<00:17, 284.02it/s] 39%|███▉      | 3119/8000 [00:11<00:16, 291.00it/s] 39%|███▉      | 3150/8000 [00:11<00:16, 295.77it/s] 40%|███▉      | 3181/8000 [00:11<00:16, 299.27it/s] 40%|████      | 3212/8000 [00:11<00:15, 301.61it/s] 41%|████      | 3243/8000 [00:11<00:15, 303.34it/s] 41%|████      | 3275/8000 [00:11<00:15, 307.71it/s] 41%|████▏     | 3306/8000 [00:11<00:17, 265.08it/s] 42%|████▏     | 3339/8000 [00:11<00:16, 281.58it/s] 42%|████▏     | 3371/8000 [00:11<00:15, 292.03it/s] 43%|████▎     | 3405/8000 [00:12<00:15, 303.11it/s] 43%|████▎     | 3440/8000 [00:12<00:14, 314.46it/s] 43%|████▎     | 3475/8000 [00:12<00:14, 323.04it/s] 44%|████▍     | 3510/8000 [00:12<00:13, 328.98it/s] 44%|████▍     | 3544/8000 [00:12<00:13, 331.49it/s] 45%|████▍     | 3578/8000 [00:12<00:13, 331.72it/s] 45%|████▌     | 3613/8000 [00:12<00:13, 334.78it/s] 46%|████▌     | 3648/8000 [00:12<00:12, 337.00it/s] 46%|████▌     | 3682/8000 [00:12<00:12, 337.66it/s] 46%|████▋     | 3717/8000 [00:12<00:12, 339.27it/s] 47%|████▋     | 3752/8000 [00:13<00:12, 340.38it/s] 47%|████▋     | 3787/8000 [00:13<00:13, 324.01it/s] 48%|████▊     | 3821/8000 [00:13<00:12, 327.47it/s] 48%|████▊     | 3855/8000 [00:13<00:12, 328.84it/s] 49%|████▊     | 3889/8000 [00:13<00:12, 330.43it/s] 49%|████▉     | 3923/8000 [00:13<00:12, 332.67it/s] 49%|████▉     | 3957/8000 [00:13<00:12, 329.98it/s] 50%|████▉     | 3991/8000 [00:13<00:12, 312.78it/s]2021-04-30 23:02:44,386 INFO     Evaluating the model... (4000/8000)
 50%|█████     | 4023/8000 [00:13<00:15, 262.46it/s] 51%|█████     | 4052/8000 [00:14<00:14, 268.51it/s] 51%|█████     | 4080/8000 [00:14<00:14, 271.48it/s] 51%|█████▏    | 4108/8000 [00:14<00:14, 268.55it/s] 52%|█████▏    | 4136/8000 [00:14<00:14, 271.13it/s] 52%|█████▏    | 4164/8000 [00:14<00:14, 260.46it/s] 52%|█████▏    | 4192/8000 [00:14<00:14, 264.63it/s] 53%|█████▎    | 4220/8000 [00:14<00:14, 266.71it/s] 53%|█████▎    | 4247/8000 [00:14<00:14, 259.65it/s] 53%|█████▎    | 4274/8000 [00:14<00:14, 254.97it/s] 54%|█████▍    | 4301/8000 [00:14<00:14, 256.91it/s] 54%|█████▍    | 4328/8000 [00:15<00:14, 258.17it/s] 54%|█████▍    | 4356/8000 [00:15<00:13, 261.74it/s] 55%|█████▍    | 4385/8000 [00:15<00:13, 268.49it/s] 55%|█████▌    | 4412/8000 [00:15<00:13, 266.31it/s] 55%|█████▌    | 4439/8000 [00:15<00:13, 267.28it/s] 56%|█████▌    | 4469/8000 [00:15<00:12, 274.66it/s] 56%|█████▌    | 4497/8000 [00:15<00:13, 269.40it/s] 57%|█████▋    | 4525/8000 [00:15<00:13, 264.80it/s] 57%|█████▋    | 4552/8000 [00:15<00:13, 262.48it/s] 57%|█████▋    | 4579/8000 [00:16<00:13, 248.05it/s] 58%|█████▊    | 4607/8000 [00:16<00:13, 254.95it/s] 58%|█████▊    | 4636/8000 [00:16<00:12, 262.44it/s] 58%|█████▊    | 4664/8000 [00:16<00:12, 266.27it/s] 59%|█████▊    | 4693/8000 [00:16<00:12, 262.43it/s] 59%|█████▉    | 4720/8000 [00:16<00:12, 258.65it/s] 59%|█████▉    | 4751/8000 [00:16<00:12, 270.20it/s] 60%|█████▉    | 4782/8000 [00:16<00:11, 278.87it/s] 60%|██████    | 4812/8000 [00:16<00:11, 284.55it/s] 61%|██████    | 4843/8000 [00:16<00:10, 291.45it/s] 61%|██████    | 4874/8000 [00:17<00:10, 294.86it/s] 61%|██████▏   | 4905/8000 [00:17<00:10, 299.17it/s] 62%|██████▏   | 4936/8000 [00:17<00:10, 300.67it/s] 62%|██████▏   | 4967/8000 [00:17<00:10, 300.88it/s] 62%|██████▏   | 4998/8000 [00:17<00:11, 266.05it/s]2021-04-30 23:02:48,122 INFO     Evaluating the model... (5000/8000)
 63%|██████▎   | 5033/8000 [00:17<00:10, 286.03it/s] 63%|██████▎   | 5067/8000 [00:17<00:09, 298.94it/s] 64%|██████▍   | 5100/8000 [00:17<00:09, 306.20it/s] 64%|██████▍   | 5135/8000 [00:17<00:09, 316.83it/s] 65%|██████▍   | 5169/8000 [00:18<00:08, 322.44it/s] 65%|██████▌   | 5203/8000 [00:18<00:08, 324.50it/s] 65%|██████▌   | 5238/8000 [00:18<00:08, 330.32it/s] 66%|██████▌   | 5272/8000 [00:18<00:08, 329.33it/s] 66%|██████▋   | 5306/8000 [00:18<00:08, 332.26it/s] 67%|██████▋   | 5340/8000 [00:18<00:08, 332.12it/s] 67%|██████▋   | 5375/8000 [00:18<00:07, 334.44it/s] 68%|██████▊   | 5409/8000 [00:18<00:07, 334.42it/s] 68%|██████▊   | 5443/8000 [00:18<00:07, 334.72it/s] 68%|██████▊   | 5477/8000 [00:18<00:08, 312.86it/s] 69%|██████▉   | 5509/8000 [00:19<00:08, 288.94it/s] 69%|██████▉   | 5539/8000 [00:19<00:08, 274.64it/s] 70%|██████▉   | 5573/8000 [00:19<00:08, 290.99it/s] 70%|███████   | 5607/8000 [00:19<00:07, 302.03it/s] 71%|███████   | 5641/8000 [00:19<00:07, 310.58it/s] 71%|███████   | 5673/8000 [00:19<00:07, 304.25it/s] 71%|███████▏  | 5704/8000 [00:19<00:07, 290.02it/s] 72%|███████▏  | 5734/8000 [00:19<00:08, 279.58it/s] 72%|███████▏  | 5763/8000 [00:20<00:07, 281.84it/s] 72%|███████▏  | 5792/8000 [00:20<00:08, 271.39it/s] 73%|███████▎  | 5821/8000 [00:20<00:07, 274.34it/s] 73%|███████▎  | 5851/8000 [00:20<00:07, 279.05it/s] 74%|███████▎  | 5880/8000 [00:20<00:08, 264.84it/s] 74%|███████▍  | 5908/8000 [00:20<00:07, 269.16it/s] 74%|███████▍  | 5938/8000 [00:20<00:07, 274.98it/s] 75%|███████▍  | 5966/8000 [00:20<00:07, 273.85it/s] 75%|███████▍  | 5994/8000 [00:20<00:08, 247.86it/s]2021-04-30 23:02:51,485 INFO     Evaluating the model... (6000/8000)
 75%|███████▌  | 6021/8000 [00:20<00:07, 253.87it/s] 76%|███████▌  | 6049/8000 [00:21<00:07, 259.76it/s] 76%|███████▌  | 6076/8000 [00:21<00:07, 258.57it/s] 76%|███████▋  | 6105/8000 [00:21<00:07, 266.46it/s] 77%|███████▋  | 6132/8000 [00:21<00:07, 261.07it/s] 77%|███████▋  | 6159/8000 [00:21<00:09, 199.23it/s] 77%|███████▋  | 6182/8000 [00:21<00:09, 185.96it/s] 78%|███████▊  | 6210/8000 [00:21<00:08, 205.74it/s] 78%|███████▊  | 6238/8000 [00:21<00:07, 222.13it/s] 78%|███████▊  | 6267/8000 [00:22<00:07, 237.28it/s] 79%|███████▊  | 6293/8000 [00:22<00:07, 240.98it/s] 79%|███████▉  | 6321/8000 [00:22<00:06, 250.18it/s] 79%|███████▉  | 6349/8000 [00:22<00:06, 257.69it/s] 80%|███████▉  | 6380/8000 [00:22<00:06, 269.46it/s] 80%|████████  | 6408/8000 [00:22<00:05, 272.18it/s] 80%|████████  | 6436/8000 [00:22<00:05, 272.03it/s] 81%|████████  | 6467/8000 [00:22<00:05, 281.18it/s] 81%|████████  | 6497/8000 [00:22<00:05, 284.50it/s] 82%|████████▏ | 6528/8000 [00:22<00:05, 289.34it/s] 82%|████████▏ | 6558/8000 [00:23<00:04, 289.81it/s] 82%|████████▏ | 6589/8000 [00:23<00:04, 293.30it/s] 83%|████████▎ | 6619/8000 [00:23<00:04, 292.00it/s] 83%|████████▎ | 6651/8000 [00:23<00:04, 298.98it/s] 84%|████████▎ | 6681/8000 [00:23<00:05, 261.20it/s] 84%|████████▍ | 6715/8000 [00:23<00:04, 278.86it/s] 84%|████████▍ | 6749/8000 [00:23<00:04, 293.29it/s] 85%|████████▍ | 6782/8000 [00:23<00:04, 302.00it/s] 85%|████████▌ | 6813/8000 [00:23<00:04, 295.12it/s] 86%|████████▌ | 6847/8000 [00:24<00:03, 305.40it/s] 86%|████████▌ | 6880/8000 [00:24<00:03, 311.11it/s] 86%|████████▋ | 6913/8000 [00:24<00:03, 314.89it/s] 87%|████████▋ | 6947/8000 [00:24<00:03, 319.32it/s] 87%|████████▋ | 6980/8000 [00:24<00:03, 316.48it/s]2021-04-30 23:02:55,110 INFO     Evaluating the model... (7000/8000)
 88%|████████▊ | 7013/8000 [00:24<00:03, 318.42it/s] 88%|████████▊ | 7047/8000 [00:24<00:02, 322.60it/s] 88%|████████▊ | 7080/8000 [00:24<00:02, 323.45it/s] 89%|████████▉ | 7113/8000 [00:24<00:02, 325.14it/s] 89%|████████▉ | 7147/8000 [00:24<00:02, 327.49it/s] 90%|████████▉ | 7180/8000 [00:25<00:02, 311.00it/s] 90%|█████████ | 7214/8000 [00:25<00:02, 316.72it/s] 91%|█████████ | 7247/8000 [00:25<00:02, 319.66it/s] 91%|█████████ | 7281/8000 [00:25<00:02, 324.83it/s] 91%|█████████▏| 7314/8000 [00:25<00:02, 326.30it/s] 92%|█████████▏| 7347/8000 [00:25<00:02, 303.59it/s] 92%|█████████▏| 7378/8000 [00:25<00:02, 294.26it/s] 93%|█████████▎| 7408/8000 [00:25<00:02, 291.57it/s] 93%|█████████▎| 7438/8000 [00:25<00:01, 292.37it/s] 93%|█████████▎| 7468/8000 [00:26<00:01, 286.19it/s] 94%|█████████▎| 7497/8000 [00:26<00:01, 284.51it/s] 94%|█████████▍| 7526/8000 [00:26<00:01, 281.79it/s] 94%|█████████▍| 7555/8000 [00:26<00:01, 273.71it/s] 95%|█████████▍| 7583/8000 [00:26<00:01, 275.55it/s] 95%|█████████▌| 7612/8000 [00:26<00:01, 277.25it/s] 96%|█████████▌| 7640/8000 [00:26<00:01, 270.54it/s] 96%|█████████▌| 7668/8000 [00:26<00:01, 268.01it/s] 96%|█████████▌| 7698/8000 [00:26<00:01, 275.60it/s] 97%|█████████▋| 7726/8000 [00:27<00:01, 271.86it/s] 97%|█████████▋| 7755/8000 [00:27<00:00, 276.86it/s] 97%|█████████▋| 7785/8000 [00:27<00:00, 281.64it/s] 98%|█████████▊| 7814/8000 [00:27<00:00, 276.85it/s] 98%|█████████▊| 7842/8000 [00:27<00:00, 273.72it/s] 98%|█████████▊| 7871/8000 [00:27<00:00, 275.83it/s] 99%|█████████▉| 7902/8000 [00:27<00:00, 282.14it/s] 99%|█████████▉| 7931/8000 [00:27<00:00, 279.66it/s]100%|█████████▉| 7960/8000 [00:27<00:00, 265.59it/s]100%|█████████▉| 7988/8000 [00:27<00:00, 269.25it/s]100%|██████████| 8000/8000 [00:28<00:00, 285.47it/s]
2021-04-30 23:02:58,598 INFO     Valid 2u-DNF MRR at step 99999: 0.267515
2021-04-30 23:02:58,598 INFO     Valid 2u-DNF HITS1 at step 99999: 0.154259
2021-04-30 23:02:58,598 INFO     Valid 2u-DNF HITS3 at step 99999: 0.302181
2021-04-30 23:02:58,598 INFO     Valid 2u-DNF HITS10 at step 99999: 0.502268
2021-04-30 23:02:58,598 INFO     Valid 2u-DNF num_queries at step 99999: 8000.000000
2021-04-30 23:02:58,600 INFO     Valid average MRR at step 99999: 0.267515
2021-04-30 23:02:58,600 INFO     Valid average HITS1 at step 99999: 0.154259
2021-04-30 23:02:58,600 INFO     Valid average HITS3 at step 99999: 0.302181
2021-04-30 23:02:58,600 INFO     Valid average HITS10 at step 99999: 0.502268
2021-04-30 23:02:58,600 INFO     Evaluating on Test Dataset...
  0%|          | 0/8000 [00:00<?, ?it/s]2021-04-30 23:02:58,615 INFO     Evaluating the model... (0/8000)
  0%|          | 27/8000 [00:00<00:29, 266.96it/s]  1%|          | 56/8000 [00:00<00:29, 272.36it/s]  1%|          | 86/8000 [00:00<00:28, 280.06it/s]  1%|▏         | 116/8000 [00:00<00:27, 284.86it/s]  2%|▏         | 147/8000 [00:00<00:26, 291.21it/s]  2%|▏         | 175/8000 [00:00<00:27, 285.68it/s]  3%|▎         | 206/8000 [00:00<00:26, 291.32it/s]  3%|▎         | 237/8000 [00:00<00:26, 295.64it/s]  3%|▎         | 268/8000 [00:00<00:25, 298.36it/s]  4%|▎         | 299/8000 [00:01<00:25, 300.59it/s]  4%|▍         | 330/8000 [00:01<00:25, 302.15it/s]  4%|▍         | 360/8000 [00:01<00:25, 300.06it/s]  5%|▍         | 393/8000 [00:01<00:24, 307.15it/s]  5%|▌         | 424/8000 [00:01<00:28, 267.74it/s]  6%|▌         | 459/8000 [00:01<00:26, 286.57it/s]  6%|▌         | 492/8000 [00:01<00:25, 297.91it/s]  7%|▋         | 523/8000 [00:01<00:25, 292.47it/s]  7%|▋         | 556/8000 [00:01<00:24, 300.71it/s]  7%|▋         | 589/8000 [00:01<00:24, 306.91it/s]  8%|▊         | 622/8000 [00:02<00:23, 311.32it/s]  8%|▊         | 655/8000 [00:02<00:23, 315.91it/s]  9%|▊         | 687/8000 [00:02<00:23, 316.94it/s]  9%|▉         | 720/8000 [00:02<00:22, 318.09it/s]  9%|▉         | 753/8000 [00:02<00:22, 321.35it/s] 10%|▉         | 786/8000 [00:02<00:22, 319.39it/s] 10%|█         | 819/8000 [00:02<00:22, 321.72it/s] 11%|█         | 852/8000 [00:02<00:23, 305.84it/s] 11%|█         | 886/8000 [00:02<00:22, 315.11it/s] 12%|█▏        | 920/8000 [00:03<00:22, 320.82it/s] 12%|█▏        | 955/8000 [00:03<00:21, 326.82it/s] 12%|█▏        | 989/8000 [00:03<00:21, 329.01it/s]2021-04-30 23:03:01,869 INFO     Evaluating the model... (1000/8000)
 13%|█▎        | 1023/8000 [00:03<00:21, 331.04it/s] 13%|█▎        | 1057/8000 [00:03<00:20, 333.40it/s] 14%|█▎        | 1091/8000 [00:03<00:22, 307.16it/s] 14%|█▍        | 1123/8000 [00:03<00:23, 296.24it/s] 14%|█▍        | 1154/8000 [00:03<00:23, 287.55it/s] 15%|█▍        | 1184/8000 [00:03<00:24, 282.80it/s] 15%|█▌        | 1214/8000 [00:04<00:23, 286.81it/s] 16%|█▌        | 1243/8000 [00:04<00:23, 282.91it/s] 16%|█▌        | 1272/8000 [00:04<00:24, 278.58it/s] 16%|█▋        | 1300/8000 [00:04<00:24, 273.14it/s] 17%|█▋        | 1328/8000 [00:04<00:24, 269.68it/s] 17%|█▋        | 1358/8000 [00:04<00:24, 275.71it/s] 17%|█▋        | 1389/8000 [00:04<00:23, 283.57it/s] 18%|█▊        | 1418/8000 [00:04<00:23, 277.64it/s] 18%|█▊        | 1447/8000 [00:04<00:23, 280.50it/s] 18%|█▊        | 1476/8000 [00:04<00:23, 278.51it/s] 19%|█▉        | 1507/8000 [00:05<00:23, 281.90it/s] 19%|█▉        | 1536/8000 [00:05<00:22, 283.07it/s] 20%|█▉        | 1565/8000 [00:05<00:22, 281.34it/s] 20%|█▉        | 1594/8000 [00:05<00:23, 275.04it/s] 20%|██        | 1622/8000 [00:05<00:23, 273.61it/s] 21%|██        | 1653/8000 [00:05<00:22, 281.57it/s] 21%|██        | 1682/8000 [00:05<00:22, 280.29it/s] 21%|██▏       | 1711/8000 [00:05<00:22, 279.69it/s] 22%|██▏       | 1740/8000 [00:05<00:23, 265.63it/s] 22%|██▏       | 1768/8000 [00:06<00:23, 267.29it/s] 22%|██▏       | 1796/8000 [00:06<00:23, 269.01it/s] 23%|██▎       | 1823/8000 [00:06<00:24, 249.18it/s] 23%|██▎       | 1849/8000 [00:06<00:24, 251.17it/s] 23%|██▎       | 1876/8000 [00:06<00:24, 252.95it/s] 24%|██▍       | 1905/8000 [00:06<00:23, 262.74it/s] 24%|██▍       | 1932/8000 [00:06<00:25, 238.30it/s] 25%|██▍       | 1962/8000 [00:06<00:23, 252.00it/s] 25%|██▍       | 1993/8000 [00:06<00:22, 265.25it/s]2021-04-30 23:03:05,534 INFO     Evaluating the model... (2000/8000)
 25%|██▌       | 2023/8000 [00:06<00:21, 271.97it/s] 26%|██▌       | 2051/8000 [00:07<00:22, 268.02it/s] 26%|██▌       | 2080/8000 [00:07<00:21, 274.18it/s] 26%|██▋       | 2111/8000 [00:07<00:20, 281.88it/s] 27%|██▋       | 2140/8000 [00:07<00:23, 248.56it/s] 27%|██▋       | 2172/8000 [00:07<00:21, 264.91it/s] 28%|██▊       | 2205/8000 [00:07<00:20, 280.76it/s] 28%|██▊       | 2235/8000 [00:07<00:20, 285.93it/s] 28%|██▊       | 2266/8000 [00:07<00:19, 290.76it/s] 29%|██▊       | 2299/8000 [00:07<00:18, 301.39it/s] 29%|██▉       | 2333/8000 [00:08<00:18, 310.85it/s] 30%|██▉       | 2367/8000 [00:08<00:17, 316.72it/s] 30%|███       | 2401/8000 [00:08<00:17, 321.66it/s] 30%|███       | 2434/8000 [00:08<00:17, 321.43it/s] 31%|███       | 2468/8000 [00:08<00:17, 324.78it/s] 31%|███▏      | 2501/8000 [00:08<00:16, 323.78it/s] 32%|███▏      | 2535/8000 [00:08<00:16, 326.10it/s] 32%|███▏      | 2569/8000 [00:08<00:16, 327.67it/s] 33%|███▎      | 2602/8000 [00:08<00:17, 311.71it/s] 33%|███▎      | 2634/8000 [00:09<00:17, 313.64it/s] 33%|███▎      | 2668/8000 [00:09<00:16, 319.25it/s] 34%|███▍      | 2701/8000 [00:09<00:16, 317.41it/s] 34%|███▍      | 2735/8000 [00:09<00:16, 321.21it/s] 35%|███▍      | 2768/8000 [00:09<00:16, 310.01it/s] 35%|███▌      | 2800/8000 [00:09<00:17, 297.79it/s] 35%|███▌      | 2830/8000 [00:09<00:18, 282.05it/s] 36%|███▌      | 2859/8000 [00:09<00:18, 277.21it/s] 36%|███▌      | 2889/8000 [00:09<00:18, 281.70it/s] 36%|███▋      | 2918/8000 [00:09<00:18, 270.95it/s] 37%|███▋      | 2946/8000 [00:10<00:18, 270.65it/s] 37%|███▋      | 2974/8000 [00:10<00:18, 267.77it/s]2021-04-30 23:03:08,917 INFO     Evaluating the model... (3000/8000)
 38%|███▊      | 3001/8000 [00:10<00:18, 263.80it/s] 38%|███▊      | 3031/8000 [00:10<00:18, 271.53it/s] 38%|███▊      | 3059/8000 [00:10<00:18, 261.84it/s] 39%|███▊      | 3087/8000 [00:10<00:18, 264.86it/s] 39%|███▉      | 3114/8000 [00:10<00:20, 234.12it/s] 39%|███▉      | 3141/8000 [00:10<00:19, 243.75it/s] 40%|███▉      | 3167/8000 [00:10<00:19, 246.55it/s] 40%|███▉      | 3193/8000 [00:11<00:19, 246.73it/s] 40%|████      | 3219/8000 [00:11<00:19, 248.62it/s] 41%|████      | 3249/8000 [00:11<00:18, 260.73it/s] 41%|████      | 3276/8000 [00:11<00:18, 256.93it/s] 41%|████▏     | 3305/8000 [00:11<00:17, 265.69it/s] 42%|████▏     | 3333/8000 [00:11<00:17, 268.19it/s] 42%|████▏     | 3361/8000 [00:11<00:17, 270.29it/s] 42%|████▏     | 3392/8000 [00:11<00:16, 279.99it/s] 43%|████▎     | 3421/8000 [00:11<00:16, 275.41it/s] 43%|████▎     | 3450/8000 [00:12<00:16, 279.00it/s] 43%|████▎     | 3479/8000 [00:12<00:17, 262.88it/s] 44%|████▍     | 3506/8000 [00:12<00:17, 263.26it/s] 44%|████▍     | 3534/8000 [00:12<00:16, 267.19it/s] 45%|████▍     | 3561/8000 [00:12<00:16, 267.41it/s] 45%|████▍     | 3588/8000 [00:12<00:16, 265.84it/s] 45%|████▌     | 3615/8000 [00:12<00:20, 211.52it/s] 45%|████▌     | 3638/8000 [00:12<00:23, 182.54it/s] 46%|████▌     | 3659/8000 [00:13<00:25, 170.30it/s] 46%|████▌     | 3678/8000 [00:13<00:27, 157.81it/s] 46%|████▋     | 3700/8000 [00:13<00:25, 168.22it/s] 47%|████▋     | 3727/8000 [00:13<00:22, 189.29it/s] 47%|████▋     | 3760/8000 [00:13<00:19, 215.92it/s] 47%|████▋     | 3795/8000 [00:13<00:17, 242.68it/s] 48%|████▊     | 3828/8000 [00:13<00:15, 262.23it/s] 48%|████▊     | 3862/8000 [00:13<00:14, 280.03it/s] 49%|████▊     | 3895/8000 [00:13<00:14, 291.49it/s] 49%|████▉     | 3928/8000 [00:14<00:13, 301.40it/s] 50%|████▉     | 3960/8000 [00:14<00:13, 306.38it/s] 50%|████▉     | 3993/8000 [00:14<00:12, 311.78it/s]2021-04-30 23:03:12,847 INFO     Evaluating the model... (4000/8000)
 50%|█████     | 4025/8000 [00:14<00:12, 313.92it/s] 51%|█████     | 4059/8000 [00:14<00:12, 316.65it/s] 51%|█████     | 4093/8000 [00:14<00:12, 320.57it/s] 52%|█████▏    | 4126/8000 [00:14<00:12, 320.69it/s] 52%|█████▏    | 4159/8000 [00:14<00:11, 322.95it/s] 52%|█████▏    | 4192/8000 [00:14<00:12, 310.54it/s] 53%|█████▎    | 4224/8000 [00:14<00:12, 310.07it/s] 53%|█████▎    | 4256/8000 [00:15<00:11, 312.08it/s] 54%|█████▎    | 4289/8000 [00:15<00:11, 316.52it/s] 54%|█████▍    | 4321/8000 [00:15<00:11, 317.39it/s] 54%|█████▍    | 4354/8000 [00:15<00:11, 319.67it/s] 55%|█████▍    | 4387/8000 [00:15<00:12, 300.71it/s] 55%|█████▌    | 4418/8000 [00:15<00:12, 288.28it/s] 56%|█████▌    | 4448/8000 [00:15<00:13, 270.71it/s] 56%|█████▌    | 4476/8000 [00:15<00:13, 269.79it/s] 56%|█████▋    | 4506/8000 [00:15<00:12, 275.38it/s] 57%|█████▋    | 4535/8000 [00:16<00:12, 278.26it/s] 57%|█████▋    | 4563/8000 [00:16<00:14, 240.24it/s] 57%|█████▋    | 4590/8000 [00:16<00:13, 247.23it/s] 58%|█████▊    | 4618/8000 [00:16<00:13, 256.09it/s] 58%|█████▊    | 4645/8000 [00:16<00:12, 259.28it/s] 58%|█████▊    | 4672/8000 [00:16<00:12, 262.17it/s] 59%|█████▉    | 4700/8000 [00:16<00:12, 264.41it/s] 59%|█████▉    | 4730/8000 [00:16<00:12, 271.19it/s] 59%|█████▉    | 4759/8000 [00:16<00:11, 274.23it/s] 60%|█████▉    | 4787/8000 [00:16<00:11, 272.47it/s] 60%|██████    | 4815/8000 [00:17<00:11, 269.62it/s] 61%|██████    | 4845/8000 [00:17<00:11, 275.93it/s] 61%|██████    | 4874/8000 [00:17<00:11, 268.13it/s] 61%|██████▏   | 4904/8000 [00:17<00:11, 272.56it/s] 62%|██████▏   | 4934/8000 [00:17<00:10, 279.88it/s] 62%|██████▏   | 4963/8000 [00:17<00:11, 273.27it/s] 62%|██████▏   | 4991/8000 [00:17<00:10, 274.38it/s]2021-04-30 23:03:16,383 INFO     Evaluating the model... (5000/8000)
 63%|██████▎   | 5020/8000 [00:17<00:10, 277.22it/s] 63%|██████▎   | 5048/8000 [00:17<00:11, 260.43it/s] 63%|██████▎   | 5079/8000 [00:18<00:10, 272.57it/s] 64%|██████▍   | 5109/8000 [00:18<00:10, 279.13it/s] 64%|██████▍   | 5138/8000 [00:18<00:10, 279.47it/s] 65%|██████▍   | 5167/8000 [00:18<00:10, 278.52it/s] 65%|██████▍   | 5198/8000 [00:18<00:09, 286.57it/s] 65%|██████▌   | 5230/8000 [00:18<00:09, 293.58it/s] 66%|██████▌   | 5261/8000 [00:18<00:09, 297.51it/s] 66%|██████▌   | 5292/8000 [00:18<00:08, 301.14it/s] 67%|██████▋   | 5323/8000 [00:18<00:08, 297.57it/s] 67%|██████▋   | 5355/8000 [00:18<00:08, 301.19it/s] 67%|██████▋   | 5386/8000 [00:19<00:08, 303.40it/s] 68%|██████▊   | 5417/8000 [00:19<00:09, 265.41it/s] 68%|██████▊   | 5450/8000 [00:19<00:09, 279.99it/s] 69%|██████▊   | 5482/8000 [00:19<00:08, 290.19it/s] 69%|██████▉   | 5515/8000 [00:19<00:08, 299.78it/s] 69%|██████▉   | 5547/8000 [00:19<00:08, 304.70it/s] 70%|██████▉   | 5581/8000 [00:19<00:07, 312.75it/s] 70%|███████   | 5615/8000 [00:19<00:07, 318.96it/s] 71%|███████   | 5648/8000 [00:19<00:07, 320.99it/s] 71%|███████   | 5681/8000 [00:20<00:07, 310.25it/s] 71%|███████▏  | 5714/8000 [00:20<00:07, 313.54it/s] 72%|███████▏  | 5748/8000 [00:20<00:07, 319.39it/s] 72%|███████▏  | 5781/8000 [00:20<00:06, 320.54it/s] 73%|███████▎  | 5815/8000 [00:20<00:06, 324.31it/s] 73%|███████▎  | 5848/8000 [00:20<00:06, 320.84it/s] 74%|███████▎  | 5882/8000 [00:20<00:06, 324.49it/s] 74%|███████▍  | 5916/8000 [00:20<00:06, 327.50it/s] 74%|███████▍  | 5949/8000 [00:20<00:06, 325.28it/s] 75%|███████▍  | 5983/8000 [00:20<00:06, 328.54it/s]2021-04-30 23:03:19,652 INFO     Evaluating the model... (6000/8000)
 75%|███████▌  | 6016/8000 [00:21<00:06, 322.10it/s] 76%|███████▌  | 6049/8000 [00:21<00:06, 318.45it/s] 76%|███████▌  | 6081/8000 [00:21<00:06, 301.74it/s] 76%|███████▋  | 6112/8000 [00:21<00:06, 289.26it/s] 77%|███████▋  | 6142/8000 [00:21<00:06, 272.79it/s] 77%|███████▋  | 6170/8000 [00:21<00:06, 272.42it/s] 77%|███████▋  | 6199/8000 [00:21<00:06, 274.67it/s] 78%|███████▊  | 6227/8000 [00:21<00:06, 269.03it/s] 78%|███████▊  | 6256/8000 [00:21<00:06, 273.41it/s] 79%|███████▊  | 6284/8000 [00:22<00:06, 267.63it/s] 79%|███████▉  | 6311/8000 [00:22<00:06, 267.95it/s] 79%|███████▉  | 6338/8000 [00:22<00:06, 262.20it/s] 80%|███████▉  | 6366/8000 [00:22<00:06, 264.47it/s] 80%|███████▉  | 6394/8000 [00:22<00:05, 268.34it/s] 80%|████████  | 6421/8000 [00:22<00:06, 257.92it/s] 81%|████████  | 6447/8000 [00:22<00:06, 249.72it/s] 81%|████████  | 6473/8000 [00:22<00:06, 252.39it/s] 81%|████████▏ | 6502/8000 [00:22<00:05, 261.73it/s] 82%|████████▏ | 6529/8000 [00:23<00:05, 262.53it/s] 82%|████████▏ | 6557/8000 [00:23<00:05, 266.04it/s] 82%|████████▏ | 6584/8000 [00:23<00:05, 264.94it/s] 83%|████████▎ | 6612/8000 [00:23<00:05, 267.09it/s] 83%|████████▎ | 6640/8000 [00:23<00:05, 269.57it/s] 83%|████████▎ | 6671/8000 [00:23<00:04, 279.39it/s] 84%|████████▍ | 6700/8000 [00:23<00:04, 276.70it/s] 84%|████████▍ | 6729/8000 [00:23<00:04, 279.63it/s] 84%|████████▍ | 6760/8000 [00:23<00:04, 286.19it/s] 85%|████████▍ | 6789/8000 [00:23<00:04, 285.47it/s] 85%|████████▌ | 6818/8000 [00:24<00:04, 285.51it/s] 86%|████████▌ | 6848/8000 [00:24<00:04, 285.86it/s] 86%|████████▌ | 6880/8000 [00:24<00:03, 292.94it/s] 86%|████████▋ | 6911/8000 [00:24<00:03, 296.80it/s] 87%|████████▋ | 6941/8000 [00:24<00:03, 297.41it/s] 87%|████████▋ | 6973/8000 [00:24<00:03, 301.39it/s]2021-04-30 23:03:23,277 INFO     Evaluating the model... (7000/8000)
 88%|████████▊ | 7004/8000 [00:24<00:03, 296.09it/s] 88%|████████▊ | 7034/8000 [00:24<00:04, 229.65it/s] 88%|████████▊ | 7060/8000 [00:25<00:04, 216.10it/s] 89%|████████▊ | 7094/8000 [00:25<00:03, 242.13it/s] 89%|████████▉ | 7127/8000 [00:25<00:03, 261.83it/s] 90%|████████▉ | 7161/8000 [00:25<00:03, 279.65it/s] 90%|████████▉ | 7195/8000 [00:25<00:02, 295.03it/s] 90%|█████████ | 7228/8000 [00:25<00:02, 304.35it/s] 91%|█████████ | 7263/8000 [00:25<00:02, 314.37it/s] 91%|█████████ | 7297/8000 [00:25<00:02, 321.43it/s] 92%|█████████▏| 7330/8000 [00:25<00:02, 323.68it/s] 92%|█████████▏| 7363/8000 [00:25<00:01, 325.05it/s] 92%|█████████▏| 7396/8000 [00:26<00:01, 321.05it/s] 93%|█████████▎| 7429/8000 [00:26<00:01, 308.15it/s] 93%|█████████▎| 7463/8000 [00:26<00:01, 316.92it/s] 94%|█████████▎| 7498/8000 [00:26<00:01, 323.62it/s] 94%|█████████▍| 7531/8000 [00:26<00:01, 325.16it/s] 95%|█████████▍| 7565/8000 [00:26<00:01, 329.21it/s] 95%|█████████▍| 7599/8000 [00:26<00:01, 328.73it/s] 95%|█████████▌| 7632/8000 [00:26<00:01, 317.75it/s] 96%|█████████▌| 7664/8000 [00:26<00:01, 304.59it/s] 96%|█████████▌| 7698/8000 [00:26<00:00, 313.67it/s] 97%|█████████▋| 7730/8000 [00:27<00:00, 308.22it/s] 97%|█████████▋| 7761/8000 [00:27<00:00, 296.69it/s] 97%|█████████▋| 7791/8000 [00:27<00:00, 296.11it/s] 98%|█████████▊| 7821/8000 [00:27<00:00, 294.86it/s] 98%|█████████▊| 7851/8000 [00:27<00:00, 282.45it/s] 98%|█████████▊| 7880/8000 [00:27<00:00, 276.00it/s] 99%|█████████▉| 7908/8000 [00:27<00:00, 276.60it/s] 99%|█████████▉| 7939/8000 [00:27<00:00, 283.86it/s]100%|█████████▉| 7968/8000 [00:27<00:00, 273.27it/s]100%|█████████▉| 7998/8000 [00:28<00:00, 277.87it/s]100%|██████████| 8000/8000 [00:28<00:00, 285.02it/s]
2021-04-30 23:03:26,686 INFO     Test 2u-DNF MRR at step 99999: 0.424008
2021-04-30 23:03:26,686 INFO     Test 2u-DNF HITS1 at step 99999: 0.317257
2021-04-30 23:03:26,686 INFO     Test 2u-DNF HITS3 at step 99999: 0.472320
2021-04-30 23:03:26,686 INFO     Test 2u-DNF HITS10 at step 99999: 0.635080
2021-04-30 23:03:26,686 INFO     Test 2u-DNF num_queries at step 99999: 8000.000000
2021-04-30 23:03:26,688 INFO     Test average MRR at step 99999: 0.424008
2021-04-30 23:03:26,688 INFO     Test average HITS1 at step 99999: 0.317257
2021-04-30 23:03:26,688 INFO     Test average HITS3 at step 99999: 0.472320
2021-04-30 23:03:26,688 INFO     Test average HITS10 at step 99999: 0.635080
2021-04-30 23:03:26,689 INFO     Training finished!!
main.py --do_valid --do_test --data_path data/FB15k-betae -n 1 -b 1000 -d 1000 -lr 0.1 --disable_warmup --max_steps 1000 --cpu_num 0 --geo cqd --valid_steps 20 --tasks 2u --print_on_screen --test_batch_size 1 --optimizer Adagrad --reg_weight 0.05 --log_steps 5 --checkpoint_path models/fb15k-betae --cqd d2 --cqd-t-norm prod --cqd-sigmoid --cqd-k 4 --no-save --cuda
overwritting args.save_path
logging to models/fb15k-betae
99999
