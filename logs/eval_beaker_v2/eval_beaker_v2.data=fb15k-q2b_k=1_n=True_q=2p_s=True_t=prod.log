2021-04-29 19:26:36,639 INFO     ---------------------------------------------------------------------------------------------
2021-04-29 19:26:36,640 INFO     Geo: cqd
2021-04-29 19:26:36,640 INFO     Data Path: data/FB15k-q2b
2021-04-29 19:26:36,640 INFO     #entity: 14951
2021-04-29 19:26:36,640 INFO     #relation: 2690
2021-04-29 19:26:36,640 INFO     #max steps: 1000
2021-04-29 19:26:36,640 INFO     Evaluate unoins using: DNF
2021-04-29 19:26:36,640 INFO     loading data
2021-04-29 19:27:40,034 INFO     Training info:
2021-04-29 19:27:40,035 INFO     Validation info:
2021-04-29 19:27:40,035 INFO     2p: 8000
2021-04-29 19:27:40,040 INFO     Test info:
2021-04-29 19:27:40,040 INFO     2p: 8000
2021-04-29 19:27:40,364 INFO     Model Parameter Configuration:
2021-04-29 19:27:40,364 INFO     Parameter embeddings.0.weight: torch.Size([14951, 2000]), require_grad = True
2021-04-29 19:27:40,365 INFO     Parameter embeddings.1.weight: torch.Size([2690, 2000]), require_grad = True
2021-04-29 19:27:40,365 INFO     Parameter Number: 35282000
2021-04-29 19:27:42,812 INFO     Loading checkpoint models/fb15k-q2b...
2021-04-29 19:27:43,117 INFO     tasks = 2p
2021-04-29 19:27:43,117 INFO     init_step = 99999
2021-04-29 19:27:43,117 INFO     batch_size = 1000
2021-04-29 19:27:43,117 INFO     hidden_dim = 1000
2021-04-29 19:27:43,117 INFO     gamma = 12.000000
2021-04-29 19:27:43,117 INFO     Evaluating on Valid Dataset...
  0%|          | 0/8000 [00:00<?, ?it/s]2021-04-29 19:27:43,135 INFO     Evaluating the model... (0/8000)
  0%|          | 26/8000 [00:00<00:31, 253.88it/s]  1%|          | 56/8000 [00:00<00:30, 264.26it/s]  1%|          | 84/8000 [00:00<00:29, 268.59it/s]  1%|▏         | 114/8000 [00:00<00:28, 275.76it/s]  2%|▏         | 144/8000 [00:00<00:27, 281.02it/s]  2%|▏         | 174/8000 [00:00<00:27, 284.97it/s]  3%|▎         | 204/8000 [00:00<00:27, 287.79it/s]  3%|▎         | 234/8000 [00:00<00:26, 289.35it/s]  3%|▎         | 264/8000 [00:00<00:26, 289.89it/s]  4%|▎         | 294/8000 [00:01<00:26, 291.45it/s]  4%|▍         | 324/8000 [00:01<00:26, 292.18it/s]  4%|▍         | 354/8000 [00:01<00:26, 291.74it/s]  5%|▍         | 384/8000 [00:01<00:26, 292.49it/s]  5%|▌         | 414/8000 [00:01<00:25, 292.53it/s]  6%|▌         | 444/8000 [00:01<00:26, 288.23it/s]  6%|▌         | 474/8000 [00:01<00:25, 290.27it/s]  6%|▋         | 504/8000 [00:01<00:25, 291.66it/s]  7%|▋         | 534/8000 [00:01<00:25, 291.88it/s]  7%|▋         | 564/8000 [00:01<00:25, 292.05it/s]  7%|▋         | 594/8000 [00:02<00:25, 285.46it/s]  8%|▊         | 623/8000 [00:02<00:26, 283.35it/s]  8%|▊         | 652/8000 [00:02<00:26, 282.49it/s]  9%|▊         | 681/8000 [00:02<00:26, 276.75it/s]  9%|▉         | 711/8000 [00:02<00:25, 281.17it/s]  9%|▉         | 741/8000 [00:02<00:25, 284.42it/s] 10%|▉         | 770/8000 [00:02<00:25, 282.60it/s] 10%|█         | 800/8000 [00:02<00:25, 285.71it/s] 10%|█         | 830/8000 [00:02<00:24, 287.70it/s] 11%|█         | 860/8000 [00:02<00:24, 289.17it/s] 11%|█         | 890/8000 [00:03<00:24, 290.28it/s] 12%|█▏        | 920/8000 [00:03<00:24, 290.66it/s] 12%|█▏        | 950/8000 [00:03<00:24, 291.37it/s] 12%|█▏        | 980/8000 [00:03<00:24, 292.42it/s]2021-04-29 19:27:46,591 INFO     Evaluating the model... (1000/8000)
 13%|█▎        | 1010/8000 [00:03<00:24, 284.96it/s] 13%|█▎        | 1039/8000 [00:03<00:24, 284.61it/s] 13%|█▎        | 1068/8000 [00:03<00:24, 286.14it/s] 14%|█▎        | 1098/8000 [00:03<00:23, 288.58it/s] 14%|█▍        | 1127/8000 [00:03<00:23, 286.48it/s] 14%|█▍        | 1157/8000 [00:04<00:23, 287.65it/s] 15%|█▍        | 1186/8000 [00:04<00:23, 288.21it/s] 15%|█▌        | 1216/8000 [00:04<00:23, 289.47it/s] 16%|█▌        | 1246/8000 [00:04<00:23, 290.01it/s] 16%|█▌        | 1276/8000 [00:04<00:23, 291.14it/s] 16%|█▋        | 1306/8000 [00:04<00:22, 291.49it/s] 17%|█▋        | 1336/8000 [00:04<00:22, 292.07it/s] 17%|█▋        | 1366/8000 [00:04<00:22, 289.74it/s] 17%|█▋        | 1395/8000 [00:04<00:23, 281.31it/s] 18%|█▊        | 1425/8000 [00:04<00:23, 284.07it/s] 18%|█▊        | 1454/8000 [00:05<00:23, 280.16it/s] 19%|█▊        | 1483/8000 [00:05<00:23, 282.93it/s] 19%|█▉        | 1512/8000 [00:05<00:22, 284.96it/s] 19%|█▉        | 1542/8000 [00:05<00:22, 287.59it/s] 20%|█▉        | 1572/8000 [00:05<00:22, 289.45it/s] 20%|██        | 1601/8000 [00:05<00:22, 289.53it/s] 20%|██        | 1631/8000 [00:05<00:21, 290.42it/s] 21%|██        | 1661/8000 [00:05<00:21, 291.41it/s] 21%|██        | 1691/8000 [00:05<00:21, 291.82it/s] 22%|██▏       | 1721/8000 [00:05<00:22, 284.63it/s] 22%|██▏       | 1750/8000 [00:06<00:22, 280.57it/s] 22%|██▏       | 1779/8000 [00:06<00:22, 282.68it/s] 23%|██▎       | 1808/8000 [00:06<00:21, 282.63it/s] 23%|██▎       | 1838/8000 [00:06<00:21, 285.76it/s] 23%|██▎       | 1868/8000 [00:06<00:21, 287.89it/s] 24%|██▎       | 1898/8000 [00:06<00:21, 289.58it/s] 24%|██▍       | 1928/8000 [00:06<00:20, 290.44it/s] 24%|██▍       | 1958/8000 [00:06<00:20, 290.74it/s] 25%|██▍       | 1988/8000 [00:06<00:20, 292.06it/s]2021-04-29 19:27:50,071 INFO     Evaluating the model... (2000/8000)
 25%|██▌       | 2018/8000 [00:07<00:20, 291.24it/s] 26%|██▌       | 2048/8000 [00:07<00:20, 289.57it/s] 26%|██▌       | 2078/8000 [00:07<00:20, 289.73it/s] 26%|██▋       | 2108/8000 [00:07<00:20, 290.74it/s] 27%|██▋       | 2138/8000 [00:07<00:20, 290.74it/s] 27%|██▋       | 2168/8000 [00:07<00:21, 276.26it/s] 27%|██▋       | 2198/8000 [00:07<00:20, 281.37it/s] 28%|██▊       | 2228/8000 [00:07<00:20, 284.49it/s] 28%|██▊       | 2258/8000 [00:07<00:20, 286.82it/s] 29%|██▊       | 2288/8000 [00:07<00:19, 288.57it/s] 29%|██▉       | 2318/8000 [00:08<00:19, 289.21it/s] 29%|██▉       | 2348/8000 [00:08<00:19, 289.77it/s] 30%|██▉       | 2378/8000 [00:08<00:19, 289.68it/s] 30%|███       | 2408/8000 [00:08<00:19, 290.20it/s] 30%|███       | 2438/8000 [00:08<00:19, 290.65it/s] 31%|███       | 2468/8000 [00:08<00:18, 291.73it/s] 31%|███       | 2498/8000 [00:08<00:19, 289.06it/s] 32%|███▏      | 2527/8000 [00:08<00:18, 289.06it/s] 32%|███▏      | 2556/8000 [00:08<00:19, 278.34it/s] 32%|███▏      | 2584/8000 [00:08<00:19, 276.43it/s] 33%|███▎      | 2614/8000 [00:09<00:19, 281.35it/s] 33%|███▎      | 2644/8000 [00:09<00:18, 284.97it/s] 33%|███▎      | 2673/8000 [00:09<00:18, 285.78it/s] 34%|███▍      | 2703/8000 [00:09<00:18, 287.92it/s] 34%|███▍      | 2732/8000 [00:09<00:18, 284.97it/s] 35%|███▍      | 2761/8000 [00:09<00:18, 278.13it/s] 35%|███▍      | 2791/8000 [00:09<00:18, 282.28it/s] 35%|███▌      | 2820/8000 [00:09<00:18, 282.49it/s] 36%|███▌      | 2849/8000 [00:09<00:18, 283.66it/s] 36%|███▌      | 2878/8000 [00:10<00:17, 285.40it/s] 36%|███▋      | 2908/8000 [00:10<00:17, 287.00it/s] 37%|███▋      | 2938/8000 [00:10<00:17, 288.99it/s] 37%|███▋      | 2967/8000 [00:10<00:17, 280.62it/s] 37%|███▋      | 2996/8000 [00:10<00:17, 278.04it/s]2021-04-29 19:27:53,583 INFO     Evaluating the model... (3000/8000)
 38%|███▊      | 3026/8000 [00:10<00:17, 282.20it/s] 38%|███▊      | 3055/8000 [00:10<00:17, 284.41it/s] 39%|███▊      | 3085/8000 [00:10<00:17, 286.18it/s] 39%|███▉      | 3115/8000 [00:10<00:16, 288.10it/s] 39%|███▉      | 3145/8000 [00:10<00:16, 289.15it/s] 40%|███▉      | 3174/8000 [00:11<00:16, 286.67it/s] 40%|████      | 3204/8000 [00:11<00:16, 288.33it/s] 40%|████      | 3234/8000 [00:11<00:16, 290.19it/s] 41%|████      | 3264/8000 [00:11<00:16, 290.35it/s] 41%|████      | 3294/8000 [00:11<00:16, 290.68it/s] 42%|████▏     | 3324/8000 [00:11<00:16, 281.09it/s] 42%|████▏     | 3353/8000 [00:11<00:16, 279.85it/s] 42%|████▏     | 3383/8000 [00:11<00:16, 283.27it/s] 43%|████▎     | 3413/8000 [00:11<00:16, 286.04it/s] 43%|████▎     | 3443/8000 [00:12<00:15, 287.48it/s] 43%|████▎     | 3473/8000 [00:12<00:15, 289.19it/s] 44%|████▍     | 3502/8000 [00:12<00:15, 286.46it/s] 44%|████▍     | 3532/8000 [00:12<00:15, 287.70it/s] 45%|████▍     | 3562/8000 [00:12<00:15, 289.44it/s] 45%|████▍     | 3592/8000 [00:12<00:15, 290.41it/s] 45%|████▌     | 3622/8000 [00:12<00:15, 291.63it/s] 46%|████▌     | 3652/8000 [00:12<00:14, 292.03it/s] 46%|████▌     | 3682/8000 [00:12<00:14, 291.68it/s] 46%|████▋     | 3712/8000 [00:12<00:14, 292.49it/s] 47%|████▋     | 3742/8000 [00:13<00:14, 291.75it/s] 47%|████▋     | 3772/8000 [00:13<00:14, 290.73it/s] 48%|████▊     | 3802/8000 [00:13<00:14, 291.32it/s] 48%|████▊     | 3832/8000 [00:13<00:14, 284.39it/s] 48%|████▊     | 3861/8000 [00:13<00:14, 280.12it/s] 49%|████▊     | 3891/8000 [00:13<00:14, 283.68it/s] 49%|████▉     | 3921/8000 [00:13<00:14, 286.15it/s] 49%|████▉     | 3951/8000 [00:13<00:14, 287.86it/s] 50%|████▉     | 3981/8000 [00:13<00:13, 289.44it/s]2021-04-29 19:27:57,051 INFO     Evaluating the model... (4000/8000)
 50%|█████     | 4010/8000 [00:13<00:13, 289.36it/s] 50%|█████     | 4040/8000 [00:14<00:13, 291.02it/s] 51%|█████     | 4070/8000 [00:14<00:13, 291.26it/s] 51%|█████▏    | 4100/8000 [00:14<00:13, 290.28it/s] 52%|█████▏    | 4130/8000 [00:14<00:13, 291.25it/s] 52%|█████▏    | 4160/8000 [00:14<00:13, 288.76it/s] 52%|█████▏    | 4189/8000 [00:14<00:13, 286.41it/s] 53%|█████▎    | 4218/8000 [00:14<00:13, 280.45it/s] 53%|█████▎    | 4248/8000 [00:14<00:13, 284.38it/s] 53%|█████▎    | 4278/8000 [00:14<00:12, 287.02it/s] 54%|█████▍    | 4308/8000 [00:14<00:12, 288.18it/s] 54%|█████▍    | 4338/8000 [00:15<00:12, 289.45it/s] 55%|█████▍    | 4368/8000 [00:15<00:12, 290.92it/s] 55%|█████▍    | 4398/8000 [00:15<00:12, 291.63it/s] 55%|█████▌    | 4428/8000 [00:15<00:12, 292.38it/s] 56%|█████▌    | 4458/8000 [00:15<00:12, 291.15it/s] 56%|█████▌    | 4488/8000 [00:15<00:12, 291.45it/s] 56%|█████▋    | 4518/8000 [00:15<00:12, 283.34it/s] 57%|█████▋    | 4547/8000 [00:15<00:12, 275.69it/s] 57%|█████▋    | 4577/8000 [00:15<00:12, 280.27it/s] 58%|█████▊    | 4607/8000 [00:16<00:11, 283.70it/s] 58%|█████▊    | 4637/8000 [00:16<00:11, 287.01it/s] 58%|█████▊    | 4667/8000 [00:16<00:11, 288.70it/s] 59%|█████▊    | 4697/8000 [00:16<00:11, 290.04it/s] 59%|█████▉    | 4727/8000 [00:16<00:11, 289.34it/s] 59%|█████▉    | 4757/8000 [00:16<00:11, 291.06it/s] 60%|█████▉    | 4787/8000 [00:16<00:10, 292.15it/s] 60%|██████    | 4817/8000 [00:16<00:10, 292.26it/s] 61%|██████    | 4847/8000 [00:16<00:10, 291.45it/s] 61%|██████    | 4877/8000 [00:16<00:10, 288.92it/s] 61%|██████▏   | 4907/8000 [00:17<00:10, 289.68it/s] 62%|██████▏   | 4937/8000 [00:17<00:10, 290.52it/s] 62%|██████▏   | 4967/8000 [00:17<00:10, 290.90it/s] 62%|██████▏   | 4997/8000 [00:17<00:10, 291.91it/s]2021-04-29 19:28:00,513 INFO     Evaluating the model... (5000/8000)
 63%|██████▎   | 5027/8000 [00:17<00:10, 291.63it/s] 63%|██████▎   | 5057/8000 [00:17<00:10, 291.93it/s] 64%|██████▎   | 5087/8000 [00:17<00:09, 291.35it/s] 64%|██████▍   | 5117/8000 [00:17<00:09, 291.54it/s] 64%|██████▍   | 5147/8000 [00:17<00:09, 291.18it/s] 65%|██████▍   | 5177/8000 [00:17<00:09, 292.38it/s] 65%|██████▌   | 5207/8000 [00:18<00:09, 288.85it/s] 65%|██████▌   | 5237/8000 [00:18<00:09, 290.59it/s] 66%|██████▌   | 5267/8000 [00:18<00:09, 290.42it/s] 66%|██████▌   | 5297/8000 [00:18<00:09, 290.83it/s] 67%|██████▋   | 5327/8000 [00:18<00:09, 291.43it/s] 67%|██████▋   | 5357/8000 [00:18<00:09, 291.48it/s] 67%|██████▋   | 5387/8000 [00:18<00:08, 290.47it/s] 68%|██████▊   | 5417/8000 [00:18<00:08, 291.17it/s] 68%|██████▊   | 5447/8000 [00:18<00:08, 292.03it/s] 68%|██████▊   | 5477/8000 [00:19<00:08, 291.08it/s] 69%|██████▉   | 5507/8000 [00:19<00:08, 292.16it/s] 69%|██████▉   | 5537/8000 [00:19<00:08, 292.05it/s] 70%|██████▉   | 5567/8000 [00:19<00:08, 287.94it/s] 70%|██████▉   | 5597/8000 [00:19<00:08, 289.35it/s] 70%|███████   | 5626/8000 [00:19<00:08, 289.46it/s] 71%|███████   | 5656/8000 [00:19<00:08, 290.41it/s] 71%|███████   | 5686/8000 [00:19<00:07, 291.54it/s] 71%|███████▏  | 5716/8000 [00:19<00:07, 291.49it/s] 72%|███████▏  | 5746/8000 [00:19<00:07, 291.50it/s] 72%|███████▏  | 5776/8000 [00:20<00:07, 291.81it/s] 73%|███████▎  | 5806/8000 [00:20<00:07, 292.20it/s] 73%|███████▎  | 5836/8000 [00:20<00:07, 291.15it/s] 73%|███████▎  | 5866/8000 [00:20<00:07, 291.17it/s] 74%|███████▎  | 5896/8000 [00:20<00:07, 289.14it/s] 74%|███████▍  | 5926/8000 [00:20<00:07, 290.10it/s] 74%|███████▍  | 5956/8000 [00:20<00:07, 291.10it/s] 75%|███████▍  | 5986/8000 [00:20<00:06, 292.09it/s]2021-04-29 19:28:03,949 INFO     Evaluating the model... (6000/8000)
 75%|███████▌  | 6016/8000 [00:20<00:06, 292.61it/s] 76%|███████▌  | 6046/8000 [00:20<00:06, 292.89it/s] 76%|███████▌  | 6076/8000 [00:21<00:06, 292.93it/s] 76%|███████▋  | 6106/8000 [00:21<00:06, 293.13it/s] 77%|███████▋  | 6136/8000 [00:21<00:06, 293.39it/s] 77%|███████▋  | 6166/8000 [00:21<00:06, 285.88it/s] 77%|███████▋  | 6195/8000 [00:21<00:06, 284.79it/s] 78%|███████▊  | 6224/8000 [00:21<00:06, 285.82it/s] 78%|███████▊  | 6254/8000 [00:21<00:06, 287.90it/s] 79%|███████▊  | 6284/8000 [00:21<00:05, 288.66it/s] 79%|███████▉  | 6313/8000 [00:21<00:05, 288.57it/s] 79%|███████▉  | 6343/8000 [00:22<00:05, 289.97it/s] 80%|███████▉  | 6373/8000 [00:22<00:05, 290.43it/s] 80%|████████  | 6403/8000 [00:22<00:05, 288.43it/s] 80%|████████  | 6433/8000 [00:22<00:05, 289.65it/s] 81%|████████  | 6462/8000 [00:22<00:05, 289.58it/s] 81%|████████  | 6492/8000 [00:22<00:05, 290.37it/s] 82%|████████▏ | 6522/8000 [00:22<00:05, 291.60it/s] 82%|████████▏ | 6552/8000 [00:22<00:04, 290.29it/s] 82%|████████▏ | 6582/8000 [00:22<00:04, 290.66it/s] 83%|████████▎ | 6612/8000 [00:22<00:04, 291.57it/s] 83%|████████▎ | 6642/8000 [00:23<00:04, 290.84it/s] 83%|████████▎ | 6672/8000 [00:23<00:04, 291.32it/s] 84%|████████▍ | 6702/8000 [00:23<00:04, 292.49it/s] 84%|████████▍ | 6732/8000 [00:23<00:04, 292.97it/s] 85%|████████▍ | 6762/8000 [00:23<00:04, 292.77it/s] 85%|████████▍ | 6792/8000 [00:23<00:04, 293.26it/s] 85%|████████▌ | 6822/8000 [00:23<00:04, 292.26it/s] 86%|████████▌ | 6852/8000 [00:23<00:03, 291.94it/s] 86%|████████▌ | 6882/8000 [00:23<00:03, 289.76it/s] 86%|████████▋ | 6912/8000 [00:23<00:03, 290.94it/s] 87%|████████▋ | 6942/8000 [00:24<00:03, 291.39it/s] 87%|████████▋ | 6972/8000 [00:24<00:03, 283.31it/s]2021-04-29 19:28:07,409 INFO     Evaluating the model... (7000/8000)
 88%|████████▊ | 7001/8000 [00:24<00:03, 278.33it/s] 88%|████████▊ | 7031/8000 [00:24<00:03, 282.77it/s] 88%|████████▊ | 7061/8000 [00:24<00:03, 285.61it/s] 89%|████████▊ | 7091/8000 [00:24<00:03, 287.98it/s] 89%|████████▉ | 7121/8000 [00:24<00:03, 289.46it/s] 89%|████████▉ | 7151/8000 [00:24<00:02, 290.94it/s] 90%|████████▉ | 7181/8000 [00:24<00:02, 290.85it/s] 90%|█████████ | 7211/8000 [00:25<00:02, 290.27it/s] 91%|█████████ | 7241/8000 [00:25<00:02, 289.18it/s] 91%|█████████ | 7270/8000 [00:25<00:02, 288.30it/s] 91%|█████████▏| 7300/8000 [00:25<00:02, 290.11it/s] 92%|█████████▏| 7330/8000 [00:25<00:02, 291.02it/s] 92%|█████████▏| 7360/8000 [00:25<00:02, 291.73it/s] 92%|█████████▏| 7390/8000 [00:25<00:02, 292.61it/s] 93%|█████████▎| 7420/8000 [00:25<00:01, 293.06it/s] 93%|█████████▎| 7450/8000 [00:25<00:01, 293.10it/s] 94%|█████████▎| 7480/8000 [00:25<00:01, 292.13it/s] 94%|█████████▍| 7510/8000 [00:26<00:01, 292.64it/s] 94%|█████████▍| 7540/8000 [00:26<00:01, 292.30it/s] 95%|█████████▍| 7570/8000 [00:26<00:01, 290.50it/s] 95%|█████████▌| 7600/8000 [00:26<00:01, 290.67it/s] 95%|█████████▌| 7630/8000 [00:26<00:01, 290.66it/s] 96%|█████████▌| 7660/8000 [00:26<00:01, 290.23it/s] 96%|█████████▌| 7690/8000 [00:26<00:01, 290.69it/s] 96%|█████████▋| 7720/8000 [00:26<00:00, 290.88it/s] 97%|█████████▋| 7750/8000 [00:26<00:00, 291.52it/s] 97%|█████████▋| 7780/8000 [00:26<00:00, 292.23it/s] 98%|█████████▊| 7810/8000 [00:27<00:00, 292.93it/s] 98%|█████████▊| 7840/8000 [00:27<00:00, 292.67it/s] 98%|█████████▊| 7870/8000 [00:27<00:00, 292.79it/s] 99%|█████████▉| 7900/8000 [00:27<00:00, 290.86it/s] 99%|█████████▉| 7930/8000 [00:27<00:00, 290.26it/s]100%|█████████▉| 7960/8000 [00:27<00:00, 290.67it/s]100%|█████████▉| 7990/8000 [00:27<00:00, 290.82it/s]100%|██████████| 8000/8000 [00:27<00:00, 288.64it/s]
2021-04-29 19:28:10,850 INFO     Valid 2p MRR at step 99999: 0.423863
2021-04-29 19:28:10,850 INFO     Valid 2p HITS1 at step 99999: 0.328706
2021-04-29 19:28:10,850 INFO     Valid 2p HITS3 at step 99999: 0.467201
2021-04-29 19:28:10,850 INFO     Valid 2p HITS10 at step 99999: 0.609042
2021-04-29 19:28:10,850 INFO     Valid 2p num_queries at step 99999: 8000.000000
2021-04-29 19:28:10,851 INFO     Valid average MRR at step 99999: 0.423863
2021-04-29 19:28:10,851 INFO     Valid average HITS1 at step 99999: 0.328706
2021-04-29 19:28:10,851 INFO     Valid average HITS3 at step 99999: 0.467201
2021-04-29 19:28:10,851 INFO     Valid average HITS10 at step 99999: 0.609042
2021-04-29 19:28:10,851 INFO     Evaluating on Test Dataset...
  0%|          | 0/8000 [00:00<?, ?it/s]2021-04-29 19:28:10,859 INFO     Evaluating the model... (0/8000)
  0%|          | 29/8000 [00:00<00:28, 282.76it/s]  1%|          | 59/8000 [00:00<00:27, 285.22it/s]  1%|          | 89/8000 [00:00<00:27, 287.23it/s]  1%|▏         | 119/8000 [00:00<00:27, 289.07it/s]  2%|▏         | 149/8000 [00:00<00:27, 290.39it/s]  2%|▏         | 179/8000 [00:00<00:26, 290.58it/s]  3%|▎         | 209/8000 [00:00<00:26, 290.82it/s]  3%|▎         | 239/8000 [00:00<00:26, 290.95it/s]  3%|▎         | 269/8000 [00:00<00:26, 291.68it/s]  4%|▎         | 299/8000 [00:01<00:26, 291.89it/s]  4%|▍         | 329/8000 [00:01<00:26, 291.73it/s]  4%|▍         | 359/8000 [00:01<00:26, 291.66it/s]  5%|▍         | 388/8000 [00:01<00:26, 283.26it/s]  5%|▌         | 417/8000 [00:01<00:27, 280.73it/s]  6%|▌         | 446/8000 [00:01<00:26, 281.32it/s]  6%|▌         | 476/8000 [00:01<00:26, 284.20it/s]  6%|▋         | 505/8000 [00:01<00:26, 282.80it/s]  7%|▋         | 535/8000 [00:01<00:26, 285.96it/s]  7%|▋         | 564/8000 [00:01<00:26, 283.88it/s]  7%|▋         | 593/8000 [00:02<00:25, 285.59it/s]  8%|▊         | 622/8000 [00:02<00:26, 283.42it/s]  8%|▊         | 651/8000 [00:02<00:26, 282.03it/s]  9%|▊         | 681/8000 [00:02<00:25, 284.97it/s]  9%|▉         | 710/8000 [00:02<00:25, 282.78it/s]  9%|▉         | 740/8000 [00:02<00:25, 285.23it/s] 10%|▉         | 769/8000 [00:02<00:25, 283.60it/s] 10%|▉         | 798/8000 [00:02<00:25, 285.43it/s] 10%|█         | 827/8000 [00:02<00:25, 284.39it/s] 11%|█         | 856/8000 [00:02<00:24, 285.85it/s] 11%|█         | 885/8000 [00:03<00:24, 285.54it/s] 11%|█▏        | 914/8000 [00:03<00:24, 286.79it/s] 12%|█▏        | 943/8000 [00:03<00:24, 285.25it/s] 12%|█▏        | 972/8000 [00:03<00:24, 286.30it/s]2021-04-29 19:28:14,349 INFO     Evaluating the model... (1000/8000)
 13%|█▎        | 1001/8000 [00:03<00:24, 284.09it/s] 13%|█▎        | 1030/8000 [00:03<00:24, 284.98it/s] 13%|█▎        | 1060/8000 [00:03<00:24, 287.27it/s] 14%|█▎        | 1089/8000 [00:03<00:24, 286.62it/s] 14%|█▍        | 1119/8000 [00:03<00:23, 288.81it/s] 14%|█▍        | 1148/8000 [00:04<00:23, 288.00it/s] 15%|█▍        | 1177/8000 [00:04<00:23, 285.85it/s] 15%|█▌        | 1207/8000 [00:04<00:23, 287.16it/s] 15%|█▌        | 1236/8000 [00:04<00:23, 286.44it/s] 16%|█▌        | 1265/8000 [00:04<00:23, 287.44it/s] 16%|█▌        | 1294/8000 [00:04<00:23, 286.65it/s] 17%|█▋        | 1323/8000 [00:04<00:24, 276.81it/s] 17%|█▋        | 1351/8000 [00:04<00:24, 275.43it/s] 17%|█▋        | 1381/8000 [00:04<00:23, 279.96it/s] 18%|█▊        | 1410/8000 [00:04<00:23, 281.67it/s] 18%|█▊        | 1439/8000 [00:05<00:23, 281.29it/s] 18%|█▊        | 1469/8000 [00:05<00:23, 283.20it/s] 19%|█▊        | 1498/8000 [00:05<00:22, 285.13it/s] 19%|█▉        | 1527/8000 [00:05<00:22, 284.89it/s] 19%|█▉        | 1557/8000 [00:05<00:22, 287.63it/s] 20%|█▉        | 1586/8000 [00:05<00:22, 286.02it/s] 20%|██        | 1615/8000 [00:05<00:22, 286.45it/s] 21%|██        | 1644/8000 [00:05<00:22, 286.68it/s] 21%|██        | 1673/8000 [00:05<00:23, 272.70it/s] 21%|██▏       | 1702/8000 [00:05<00:22, 277.44it/s] 22%|██▏       | 1732/8000 [00:06<00:22, 283.57it/s] 22%|██▏       | 1761/8000 [00:06<00:22, 283.54it/s] 22%|██▏       | 1791/8000 [00:06<00:21, 287.66it/s] 23%|██▎       | 1821/8000 [00:06<00:21, 287.09it/s] 23%|██▎       | 1851/8000 [00:06<00:21, 289.99it/s] 24%|██▎       | 1881/8000 [00:06<00:20, 292.19it/s] 24%|██▍       | 1911/8000 [00:06<00:20, 291.49it/s] 24%|██▍       | 1941/8000 [00:06<00:20, 293.49it/s] 25%|██▍       | 1971/8000 [00:06<00:20, 292.01it/s]2021-04-29 19:28:17,862 INFO     Evaluating the model... (2000/8000)
 25%|██▌       | 2001/8000 [00:07<00:21, 277.93it/s] 25%|██▌       | 2029/8000 [00:07<00:21, 273.35it/s] 26%|██▌       | 2058/8000 [00:07<00:21, 276.58it/s] 26%|██▌       | 2088/8000 [00:07<00:20, 282.62it/s] 26%|██▋       | 2117/8000 [00:07<00:20, 284.15it/s] 27%|██▋       | 2146/8000 [00:07<00:20, 285.27it/s] 27%|██▋       | 2176/8000 [00:07<00:20, 288.61it/s] 28%|██▊       | 2205/8000 [00:07<00:20, 288.05it/s] 28%|██▊       | 2234/8000 [00:07<00:20, 278.35it/s] 28%|██▊       | 2262/8000 [00:07<00:21, 265.07it/s] 29%|██▊       | 2291/8000 [00:08<00:21, 271.55it/s] 29%|██▉       | 2321/8000 [00:08<00:20, 277.84it/s] 29%|██▉       | 2350/8000 [00:08<00:20, 279.93it/s] 30%|██▉       | 2380/8000 [00:08<00:19, 284.26it/s] 30%|███       | 2409/8000 [00:08<00:19, 284.83it/s] 30%|███       | 2438/8000 [00:08<00:19, 285.73it/s] 31%|███       | 2468/8000 [00:08<00:19, 287.77it/s] 31%|███       | 2497/8000 [00:08<00:19, 287.82it/s] 32%|███▏      | 2527/8000 [00:08<00:18, 289.62it/s] 32%|███▏      | 2556/8000 [00:08<00:18, 287.61it/s] 32%|███▏      | 2586/8000 [00:09<00:18, 289.43it/s] 33%|███▎      | 2615/8000 [00:09<00:18, 289.07it/s] 33%|███▎      | 2644/8000 [00:09<00:18, 286.61it/s] 33%|███▎      | 2674/8000 [00:09<00:18, 288.05it/s] 34%|███▍      | 2703/8000 [00:09<00:18, 288.15it/s] 34%|███▍      | 2733/8000 [00:09<00:18, 290.14it/s] 35%|███▍      | 2763/8000 [00:09<00:18, 290.80it/s] 35%|███▍      | 2793/8000 [00:09<00:17, 291.92it/s] 35%|███▌      | 2823/8000 [00:09<00:17, 291.48it/s] 36%|███▌      | 2853/8000 [00:09<00:17, 290.40it/s] 36%|███▌      | 2883/8000 [00:10<00:17, 291.53it/s] 36%|███▋      | 2913/8000 [00:10<00:17, 291.80it/s] 37%|███▋      | 2943/8000 [00:10<00:17, 291.99it/s] 37%|███▋      | 2973/8000 [00:10<00:17, 292.58it/s]2021-04-29 19:28:21,350 INFO     Evaluating the model... (3000/8000)
 38%|███▊      | 3003/8000 [00:10<00:17, 291.77it/s] 38%|███▊      | 3033/8000 [00:10<00:16, 292.39it/s] 38%|███▊      | 3063/8000 [00:10<00:16, 292.79it/s] 39%|███▊      | 3093/8000 [00:10<00:16, 293.56it/s] 39%|███▉      | 3123/8000 [00:10<00:16, 293.41it/s] 39%|███▉      | 3153/8000 [00:11<00:16, 293.25it/s] 40%|███▉      | 3183/8000 [00:11<00:16, 292.99it/s] 40%|████      | 3213/8000 [00:11<00:16, 290.98it/s] 41%|████      | 3243/8000 [00:11<00:16, 292.19it/s] 41%|████      | 3273/8000 [00:11<00:16, 289.12it/s] 41%|████▏     | 3302/8000 [00:11<00:16, 277.05it/s] 42%|████▏     | 3330/8000 [00:11<00:16, 275.31it/s] 42%|████▏     | 3358/8000 [00:11<00:17, 270.89it/s] 42%|████▏     | 3386/8000 [00:11<00:17, 268.58it/s] 43%|████▎     | 3415/8000 [00:11<00:16, 273.98it/s] 43%|████▎     | 3445/8000 [00:12<00:16, 281.02it/s] 43%|████▎     | 3474/8000 [00:12<00:15, 282.98it/s] 44%|████▍     | 3504/8000 [00:12<00:15, 287.32it/s] 44%|████▍     | 3534/8000 [00:12<00:15, 287.82it/s] 45%|████▍     | 3564/8000 [00:12<00:15, 290.22it/s] 45%|████▍     | 3595/8000 [00:12<00:15, 293.26it/s] 45%|████▌     | 3625/8000 [00:12<00:14, 292.07it/s] 46%|████▌     | 3655/8000 [00:12<00:14, 292.17it/s] 46%|████▌     | 3685/8000 [00:12<00:14, 293.64it/s] 46%|████▋     | 3715/8000 [00:12<00:14, 292.81it/s] 47%|████▋     | 3746/8000 [00:13<00:14, 295.15it/s] 47%|████▋     | 3776/8000 [00:13<00:14, 292.34it/s] 48%|████▊     | 3806/8000 [00:13<00:14, 292.07it/s] 48%|████▊     | 3836/8000 [00:13<00:14, 293.26it/s] 48%|████▊     | 3866/8000 [00:13<00:14, 292.99it/s] 49%|████▊     | 3896/8000 [00:13<00:14, 292.84it/s] 49%|████▉     | 3926/8000 [00:13<00:13, 292.96it/s] 49%|████▉     | 3956/8000 [00:13<00:13, 293.63it/s] 50%|████▉     | 3986/8000 [00:13<00:13, 293.11it/s]2021-04-29 19:28:24,810 INFO     Evaluating the model... (4000/8000)
 50%|█████     | 4016/8000 [00:14<00:13, 292.54it/s] 51%|█████     | 4046/8000 [00:14<00:13, 283.95it/s] 51%|█████     | 4075/8000 [00:14<00:13, 281.75it/s] 51%|█████▏    | 4105/8000 [00:14<00:13, 285.49it/s] 52%|█████▏    | 4134/8000 [00:14<00:13, 281.11it/s] 52%|█████▏    | 4165/8000 [00:14<00:13, 286.55it/s] 52%|█████▏    | 4195/8000 [00:14<00:13, 288.86it/s] 53%|█████▎    | 4224/8000 [00:14<00:13, 288.18it/s] 53%|█████▎    | 4254/8000 [00:14<00:12, 290.73it/s] 54%|█████▎    | 4284/8000 [00:14<00:12, 289.20it/s] 54%|█████▍    | 4314/8000 [00:15<00:12, 291.33it/s] 54%|█████▍    | 4344/8000 [00:15<00:12, 291.75it/s] 55%|█████▍    | 4374/8000 [00:15<00:12, 293.04it/s] 55%|█████▌    | 4404/8000 [00:15<00:12, 289.98it/s] 55%|█████▌    | 4434/8000 [00:15<00:12, 291.97it/s] 56%|█████▌    | 4464/8000 [00:15<00:12, 291.95it/s] 56%|█████▌    | 4494/8000 [00:15<00:11, 293.59it/s] 57%|█████▋    | 4524/8000 [00:15<00:11, 291.99it/s] 57%|█████▋    | 4554/8000 [00:15<00:11, 293.39it/s] 57%|█████▋    | 4584/8000 [00:15<00:11, 291.82it/s] 58%|█████▊    | 4615/8000 [00:16<00:11, 294.31it/s] 58%|█████▊    | 4645/8000 [00:16<00:11, 292.41it/s] 58%|█████▊    | 4675/8000 [00:16<00:11, 294.18it/s] 59%|█████▉    | 4705/8000 [00:16<00:11, 292.84it/s] 59%|█████▉    | 4735/8000 [00:16<00:11, 293.33it/s] 60%|█████▉    | 4765/8000 [00:16<00:11, 292.61it/s] 60%|█████▉    | 4795/8000 [00:16<00:10, 294.17it/s] 60%|██████    | 4825/8000 [00:16<00:10, 292.76it/s] 61%|██████    | 4855/8000 [00:16<00:10, 294.52it/s] 61%|██████    | 4885/8000 [00:16<00:10, 293.78it/s] 61%|██████▏   | 4915/8000 [00:17<00:10, 294.95it/s] 62%|██████▏   | 4945/8000 [00:17<00:10, 294.19it/s] 62%|██████▏   | 4975/8000 [00:17<00:10, 293.27it/s]2021-04-29 19:28:28,244 INFO     Evaluating the model... (5000/8000)
 63%|██████▎   | 5005/8000 [00:17<00:10, 279.97it/s] 63%|██████▎   | 5035/8000 [00:17<00:10, 283.20it/s] 63%|██████▎   | 5065/8000 [00:17<00:10, 287.82it/s] 64%|██████▎   | 5095/8000 [00:17<00:10, 289.06it/s] 64%|██████▍   | 5125/8000 [00:17<00:09, 291.13it/s] 64%|██████▍   | 5155/8000 [00:17<00:09, 291.49it/s] 65%|██████▍   | 5185/8000 [00:18<00:09, 293.13it/s] 65%|██████▌   | 5215/8000 [00:18<00:09, 293.10it/s] 66%|██████▌   | 5245/8000 [00:18<00:09, 294.22it/s] 66%|██████▌   | 5275/8000 [00:18<00:09, 293.66it/s] 66%|██████▋   | 5305/8000 [00:18<00:09, 292.31it/s] 67%|██████▋   | 5335/8000 [00:18<00:09, 294.18it/s] 67%|██████▋   | 5365/8000 [00:18<00:09, 292.19it/s] 67%|██████▋   | 5395/8000 [00:18<00:08, 293.87it/s] 68%|██████▊   | 5425/8000 [00:18<00:08, 293.92it/s] 68%|██████▊   | 5455/8000 [00:18<00:08, 295.25it/s] 69%|██████▊   | 5485/8000 [00:19<00:08, 292.44it/s] 69%|██████▉   | 5515/8000 [00:19<00:08, 293.75it/s] 69%|██████▉   | 5545/8000 [00:19<00:08, 293.97it/s] 70%|██████▉   | 5575/8000 [00:19<00:08, 295.07it/s] 70%|███████   | 5605/8000 [00:19<00:08, 294.09it/s] 70%|███████   | 5635/8000 [00:19<00:08, 294.77it/s] 71%|███████   | 5666/8000 [00:19<00:07, 296.57it/s] 71%|███████   | 5696/8000 [00:19<00:07, 295.51it/s] 72%|███████▏  | 5726/8000 [00:19<00:07, 292.50it/s] 72%|███████▏  | 5756/8000 [00:19<00:07, 293.94it/s] 72%|███████▏  | 5786/8000 [00:20<00:07, 293.11it/s] 73%|███████▎  | 5816/8000 [00:20<00:07, 295.04it/s] 73%|███████▎  | 5846/8000 [00:20<00:07, 293.28it/s] 73%|███████▎  | 5876/8000 [00:20<00:07, 295.05it/s] 74%|███████▍  | 5906/8000 [00:20<00:07, 293.83it/s] 74%|███████▍  | 5936/8000 [00:20<00:07, 294.51it/s] 75%|███████▍  | 5966/8000 [00:20<00:06, 293.12it/s] 75%|███████▍  | 5996/8000 [00:20<00:06, 295.09it/s]2021-04-29 19:28:31,660 INFO     Evaluating the model... (6000/8000)
 75%|███████▌  | 6026/8000 [00:20<00:06, 292.70it/s] 76%|███████▌  | 6056/8000 [00:20<00:06, 293.76it/s] 76%|███████▌  | 6086/8000 [00:21<00:06, 290.86it/s] 76%|███████▋  | 6116/8000 [00:21<00:06, 293.03it/s] 77%|███████▋  | 6146/8000 [00:21<00:06, 293.06it/s] 77%|███████▋  | 6176/8000 [00:21<00:06, 294.82it/s] 78%|███████▊  | 6206/8000 [00:21<00:06, 294.43it/s] 78%|███████▊  | 6237/8000 [00:21<00:05, 296.25it/s] 78%|███████▊  | 6267/8000 [00:21<00:05, 295.62it/s] 79%|███████▊  | 6297/8000 [00:21<00:05, 294.61it/s] 79%|███████▉  | 6327/8000 [00:21<00:05, 295.87it/s] 79%|███████▉  | 6357/8000 [00:22<00:05, 294.40it/s] 80%|███████▉  | 6387/8000 [00:22<00:05, 295.87it/s] 80%|████████  | 6417/8000 [00:22<00:05, 293.62it/s] 81%|████████  | 6447/8000 [00:22<00:05, 293.00it/s] 81%|████████  | 6477/8000 [00:22<00:05, 288.93it/s] 81%|████████▏ | 6506/8000 [00:22<00:05, 285.86it/s] 82%|████████▏ | 6535/8000 [00:22<00:05, 284.06it/s] 82%|████████▏ | 6564/8000 [00:22<00:05, 284.25it/s] 82%|████████▏ | 6593/8000 [00:22<00:04, 282.60it/s] 83%|████████▎ | 6622/8000 [00:22<00:04, 281.64it/s] 83%|████████▎ | 6651/8000 [00:23<00:04, 280.22it/s] 84%|████████▎ | 6680/8000 [00:23<00:04, 277.54it/s] 84%|████████▍ | 6709/8000 [00:23<00:04, 278.52it/s] 84%|████████▍ | 6737/8000 [00:23<00:04, 277.45it/s] 85%|████████▍ | 6765/8000 [00:23<00:04, 277.66it/s] 85%|████████▍ | 6793/8000 [00:23<00:04, 271.25it/s] 85%|████████▌ | 6822/8000 [00:23<00:04, 273.57it/s] 86%|████████▌ | 6850/8000 [00:23<00:04, 275.10it/s] 86%|████████▌ | 6879/8000 [00:23<00:04, 276.67it/s] 86%|████████▋ | 6907/8000 [00:23<00:03, 276.05it/s] 87%|████████▋ | 6935/8000 [00:24<00:03, 276.43it/s] 87%|████████▋ | 6963/8000 [00:24<00:03, 272.54it/s] 87%|████████▋ | 6992/8000 [00:24<00:03, 274.89it/s]2021-04-29 19:28:35,185 INFO     Evaluating the model... (7000/8000)
 88%|████████▊ | 7020/8000 [00:24<00:03, 274.12it/s] 88%|████████▊ | 7049/8000 [00:24<00:03, 276.53it/s] 88%|████████▊ | 7077/8000 [00:24<00:03, 275.83it/s] 89%|████████▉ | 7105/8000 [00:24<00:03, 275.62it/s] 89%|████████▉ | 7133/8000 [00:24<00:03, 274.12it/s] 90%|████████▉ | 7162/8000 [00:24<00:03, 276.14it/s] 90%|████████▉ | 7190/8000 [00:25<00:02, 271.01it/s] 90%|█████████ | 7219/8000 [00:25<00:02, 274.22it/s] 91%|█████████ | 7247/8000 [00:25<00:02, 275.29it/s] 91%|█████████ | 7276/8000 [00:25<00:02, 274.76it/s] 91%|█████████▏| 7305/8000 [00:25<00:02, 276.45it/s] 92%|█████████▏| 7334/8000 [00:25<00:02, 278.58it/s] 92%|█████████▏| 7362/8000 [00:25<00:02, 277.18it/s] 92%|█████████▏| 7390/8000 [00:25<00:02, 277.87it/s] 93%|█████████▎| 7418/8000 [00:25<00:02, 272.15it/s] 93%|█████████▎| 7447/8000 [00:25<00:02, 274.81it/s] 93%|█████████▎| 7476/8000 [00:26<00:01, 278.47it/s] 94%|█████████▍| 7504/8000 [00:26<00:01, 278.35it/s] 94%|█████████▍| 7533/8000 [00:26<00:01, 279.96it/s] 95%|█████████▍| 7562/8000 [00:26<00:01, 280.08it/s] 95%|█████████▍| 7591/8000 [00:26<00:01, 281.86it/s] 95%|█████████▌| 7620/8000 [00:26<00:01, 281.97it/s] 96%|█████████▌| 7649/8000 [00:26<00:01, 283.28it/s] 96%|█████████▌| 7678/8000 [00:26<00:01, 283.14it/s] 96%|█████████▋| 7707/8000 [00:26<00:01, 284.48it/s] 97%|█████████▋| 7736/8000 [00:26<00:00, 280.64it/s] 97%|█████████▋| 7765/8000 [00:27<00:00, 280.05it/s] 97%|█████████▋| 7794/8000 [00:27<00:00, 278.89it/s] 98%|█████████▊| 7823/8000 [00:27<00:00, 279.84it/s] 98%|█████████▊| 7851/8000 [00:27<00:00, 277.08it/s] 98%|█████████▊| 7879/8000 [00:27<00:00, 277.76it/s] 99%|█████████▉| 7907/8000 [00:27<00:00, 274.23it/s] 99%|█████████▉| 7936/8000 [00:27<00:00, 276.18it/s]100%|█████████▉| 7964/8000 [00:27<00:00, 273.11it/s]100%|█████████▉| 7993/8000 [00:27<00:00, 275.28it/s]100%|██████████| 8000/8000 [00:27<00:00, 286.37it/s]
2021-04-29 19:28:38,800 INFO     Test 2p MRR at step 99999: 0.588967
2021-04-29 19:28:38,800 INFO     Test 2p HITS1 at step 99999: 0.531372
2021-04-29 19:28:38,800 INFO     Test 2p HITS3 at step 99999: 0.613356
2021-04-29 19:28:38,800 INFO     Test 2p HITS10 at step 99999: 0.701132
2021-04-29 19:28:38,800 INFO     Test 2p num_queries at step 99999: 8000.000000
2021-04-29 19:28:38,801 INFO     Test average MRR at step 99999: 0.588967
2021-04-29 19:28:38,801 INFO     Test average HITS1 at step 99999: 0.531372
2021-04-29 19:28:38,801 INFO     Test average HITS3 at step 99999: 0.613356
2021-04-29 19:28:38,802 INFO     Test average HITS10 at step 99999: 0.701132
2021-04-29 19:28:38,802 INFO     Training finished!!
main.py --do_valid --do_test --data_path data/FB15k-q2b -n 1 -b 1000 -d 1000 -lr 0.1 --disable_warmup --max_steps 1000 --cpu_num 0 --geo cqd --valid_steps 20 --tasks 2p --print_on_screen --test_batch_size 1 --optimizer Adagrad --reg_weight 0.05 --log_steps 5 --checkpoint_path models/fb15k-q2b --cqd d2 --cqd-t-norm prod --cqd-normalize --cqd-sigmoid --cqd-k 1 --no-save --cuda
overwritting args.save_path
logging to models/fb15k-q2b
99999
